<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.74.3" />

  <title>Titanic project using python &middot; Nyakerabachi# Blog Posts</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="/css/blackburn.css">

  
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.9.0/css/all.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="/">Blackburn</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/*" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://facebook.com/*" rel="me" target="_blank"><i class="fab fa-facebook-square fa-fw"></i>Facebook</a>
    </li>
    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://instagram.com/*" rel="me" target="_blank"><i class="fab fa-instagram fa-fw"></i>Instagram</a>
    </li>
    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/*" rel="me" target="_blank"><i class="fab fa-linkedin"></i></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/yoshiharuyamashita" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/*" rel="me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>Musa R. Nyakerabachi&copy; 2020. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Titanic project using python</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>27 Jul 2020, 00:00</time>
  </div>

  

  

  

</div>

  <!-- raw HTML omitted -->
<h2 id="1-business-understanding">1. BUSINESS UNDERSTANDING.</h2>
<p>Source:<a href="https://www.kaggle.com/c/titanic/">Machine Learning Titanic Competition</a></p>
<p>Data: <a href="https://www.kaggle.com/c/titanic/data">Titanic Data Set from Kaggle</a></p>
<h3 id="context">Context:</h3>
<p>Source: <a href="https://www.kaggle.com/c/titanic/discussion">Discussion</a></p>
<h3 id="problem-statement-">Problem statement :</h3>
<p>Using machine learning to create a model that predicts which passengers survived the Titanic shipwreck.</p>
<h2 id="21-data-description-">2.1 Data Description :</h2>
<table>
<thead>
<tr>
<th align="center">Column Name</th>
<th align="center">Description</th>
<th align="center">Key</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><strong>survival</strong></td>
<td align="center">Survival</td>
<td align="center"><strong>0</strong> = No, <strong>1</strong> = Yes</td>
</tr>
<tr>
<td align="center"><strong>pclass</strong></td>
<td align="center">Ticket class</td>
<td align="center"><strong>1</strong> = 1st, <strong>2</strong> = 2nd, <strong>3</strong> = 3rd</td>
</tr>
<tr>
<td align="center"><strong>sex</strong></td>
<td align="center">Sex</td>
<td align="center"></td>
</tr>
<tr>
<td align="center"><strong>Age</strong></td>
<td align="center">Age in years</td>
<td align="center"></td>
</tr>
<tr>
<td align="center"><strong>sibsp</strong></td>
<td align="center">Number of siblings / spouses aboard the Titanic</td>
<td align="center"></td>
</tr>
<tr>
<td align="center"><strong>parch</strong></td>
<td align="center">Number of parents / children aboard the Titanic</td>
<td align="center"></td>
</tr>
<tr>
<td align="center"><strong>ticket</strong></td>
<td align="center">Ticket number</td>
<td align="center"></td>
</tr>
<tr>
<td align="center"><strong>fare</strong></td>
<td align="center">Passenger fare</td>
<td align="center"></td>
</tr>
<tr>
<td align="center"><strong>cabin</strong></td>
<td align="center">Cabin number</td>
<td align="center"></td>
</tr>
<tr>
<td align="center"><strong>embarked</strong></td>
<td align="center">Port of Embarkation</td>
<td align="center"><strong>C</strong> = Cherbourg, <strong>Q</strong> = Queenstown, <strong>S</strong> = Southampton</td>
</tr>
</tbody>
</table>
<h2 id="211-importing-libraries">2.1.1 Importing Libraries.</h2>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#loading libraries</span>
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> seaborn <span style="color:#f92672">as</span> sns
<span style="color:#f92672">from</span> scipy.stats <span style="color:#f92672">import</span> pearsonr
<span style="color:#f92672">from</span> sklearn.linear_model <span style="color:#f92672">import</span> LogisticRegression
<span style="color:#f92672">from</span> sklearn.ensemble <span style="color:#f92672">import</span> AdaBoostClassifier, BaggingClassifier, RandomForestClassifier
<span style="color:#f92672">from</span> sklearn.svm <span style="color:#f92672">import</span> SVC
<span style="color:#f92672">from</span> sklearn.tree <span style="color:#f92672">import</span> DecisionTreeClassifier
<span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> (accuracy_score, auc, classification_report, 
                             confusion_matrix, fbeta_score,precision_score,recall_score,f1_score)
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> MinMaxScaler, StandardScaler
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> GridSearchCV, train_test_split,KFold
<span style="color:#f92672">from</span> warnings <span style="color:#f92672">import</span> filterwarnings
<span style="color:#f92672">import</span> modeling_util <span style="color:#f92672">as</span> meu
filterwarnings(<span style="color:#e6db74">&#34;ignore&#34;</span>)
<span style="color:#f92672">%</span>matplotlib inline
</code></pre></div><!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#34;train.csv&#34;</span>)
</code></pre></div><p>Getting the first four rows of the data set using <!-- raw HTML omitted -->.head()<!-- raw HTML omitted --> method.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#f92672">.</span>head()
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<h1 id="212-statistical-summary">2.1.2 Statistical Summary.</h1>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#f92672">.</span>describe(include<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>number)<span style="color:#f92672">.</span>T <span style="color:#75715e"># transposing the data set description</span>
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>From above the maximum Number of parents / children aboard the Titanic(<!-- raw HTML omitted -->Parch<!-- raw HTML omitted -->) were <!-- raw HTML omitted -->6<!-- raw HTML omitted --> while minimum being <!-- raw HTML omitted -->0<!-- raw HTML omitted -->, while maximum <!-- raw HTML omitted -->Age<!-- raw HTML omitted --> being <!-- raw HTML omitted -->80<!-- raw HTML omitted --> and minimum age being less than a year for passenges who boarded titanic and averagely most people who were in the titanic were about <!-- raw HTML omitted -->30<!-- raw HTML omitted --> years of age, while the maximum number of siblings / spouses aboard the Titanic(<!-- raw HTML omitted -->SibSp<!-- raw HTML omitted -->) was <!-- raw HTML omitted -->8<!-- raw HTML omitted --> while minimum being <!-- raw HTML omitted -->0<!-- raw HTML omitted -->, roughly the maximum amount of fare was <!-- raw HTML omitted -->512<!-- raw HTML omitted --> while minimum being <!-- raw HTML omitted -->0<!-- raw HTML omitted -->. Why is minimum <!-- raw HTML omitted -->Fare<!-- raw HTML omitted --> is <!-- raw HTML omitted -->0<!-- raw HTML omitted --> maybe children within a given threshhold are not being charged.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#f92672">.</span>info() <span style="color:#75715e"># information about data</span>
</code></pre></div><pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 891 entries, 0 to 890
Data columns (total 12 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   PassengerId  891 non-null    int64  
 1   Survived     891 non-null    int64  
 2   Pclass       891 non-null    int64  
 3   Name         891 non-null    object 
 4   Sex          891 non-null    object 
 5   Age          714 non-null    float64
 6   SibSp        891 non-null    int64  
 7   Parch        891 non-null    int64  
 8   Ticket       891 non-null    object 
 9   Fare         891 non-null    float64
 10  Cabin        204 non-null    object 
 11  Embarked     889 non-null    object 
dtypes: float64(2), int64(5), object(5)
memory usage: 83.7+ KB
</code></pre>
<p>From above there is some rows with missing <!-- raw HTML omitted -->Age<!-- raw HTML omitted -->, <!-- raw HTML omitted -->Cabin<!-- raw HTML omitted --> and <!-- raw HTML omitted -->Embarked<!-- raw HTML omitted --> i&rsquo;ll make some data imputation on them.</p>
<p>Let me group the three classes and see the average <!-- raw HTML omitted -->Age<!-- raw HTML omitted --> of people in each class using <!-- raw HTML omitted -->.groupby()<!-- raw HTML omitted --> method of the dataframe type.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">AGE <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([
    df<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#34;Pclass&#34;</span>])[<span style="color:#e6db74">&#34;Age&#34;</span>]<span style="color:#f92672">.</span>mean()
],axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
    
    
AGE
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>From the boxplot above the second class(<!-- raw HTML omitted -->Pclass<!-- raw HTML omitted -->) age has got outliers as shown above maybe <!-- raw HTML omitted -->standarndadization<!-- raw HTML omitted --> if not <!-- raw HTML omitted -->normalization<!-- raw HTML omitted --> will handle this.From above it is vividly depicted that old people boarded first class while middle aged boarded second class while children boarded third class reason being known little explation to the reason being attached since it&rsquo;s common sense.Let me use this data to make imputation on Age column for missing values with first class people age being roughly 39 from my above groupby() method of means in 3 classes, and 30 for second class while the third class being 25 years old.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">age_na</span>(fill):
    Age <span style="color:#f92672">=</span> fill[<span style="color:#ae81ff">0</span>]
    Pclass <span style="color:#f92672">=</span> fill[<span style="color:#ae81ff">1</span>]
    
    <span style="color:#66d9ef">if</span> pd<span style="color:#f92672">.</span>isnull(Age):

        <span style="color:#66d9ef">if</span> Pclass <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">39</span>

        <span style="color:#66d9ef">elif</span> Pclass <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>:
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">30</span>

        <span style="color:#66d9ef">else</span>:
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">25</span>

    <span style="color:#66d9ef">else</span>:
        <span style="color:#66d9ef">return</span> Age
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[<span style="color:#e6db74">&#39;Age&#39;</span>] <span style="color:#f92672">=</span> df[[<span style="color:#e6db74">&#39;Age&#39;</span>,<span style="color:#e6db74">&#39;Pclass&#39;</span>]]<span style="color:#f92672">.</span>apply(age_na,axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#f92672">.</span>info()
</code></pre></div><pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 891 entries, 0 to 890
Data columns (total 12 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   PassengerId  891 non-null    int64  
 1   Survived     891 non-null    int64  
 2   Pclass       891 non-null    int64  
 3   Name         891 non-null    object 
 4   Sex          891 non-null    object 
 5   Age          891 non-null    float64
 6   SibSp        891 non-null    int64  
 7   Parch        891 non-null    int64  
 8   Ticket       891 non-null    object 
 9   Fare         891 non-null    float64
 10  Cabin        204 non-null    object 
 11  Embarked     889 non-null    object 
dtypes: float64(2), int64(5), object(5)
memory usage: 83.7+ KB
</code></pre>
<p>The missing values of <!-- raw HTML omitted -->Age<!-- raw HTML omitted --> column have been filled up the remaining column with missing values are <!-- raw HTML omitted -->Embarked<!-- raw HTML omitted --> and <!-- raw HTML omitted -->Cabin<!-- raw HTML omitted --> i&rsquo;ll fill the <!-- raw HTML omitted -->Embarked<!-- raw HTML omitted --> missing values with largest number of station <!-- raw HTML omitted -->Embarked<!-- raw HTML omitted --> and also since <!-- raw HTML omitted -->Embarked<!-- raw HTML omitted --> has <!-- raw HTML omitted -->3<!-- raw HTML omitted --> distinct value i&rsquo;ll convert it to categorical data type while <!-- raw HTML omitted -->Cabin<!-- raw HTML omitted --> has alot of missing values hence i&rsquo;ll drop it during machine learning session.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">dfn <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([
    df<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#34;Pclass&#34;</span>,<span style="color:#e6db74">&#34;Embarked&#34;</span>])[<span style="color:#e6db74">&#34;Pclass&#34;</span>]<span style="color:#f92672">.</span>count()<span style="color:#75715e">#finding total number of people embarkedin each station</span>

    
], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)<span style="color:#75715e">#finding total number of people embarkedin each station</span>
dfn<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> [ <span style="color:#e6db74">&#39;Count&#39;</span>]
dfn
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>From above the <!-- raw HTML omitted -->Southampton<!-- raw HTML omitted --> station had a lot of people than rest so ill use it in filling the 2 missing values in the <!-- raw HTML omitted -->Embarked<!-- raw HTML omitted --> column.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[<span style="color:#e6db74">&#34;Embarked&#34;</span>]<span style="color:#f92672">.</span>fillna(<span style="color:#e6db74">&#34;S&#34;</span>,inplace <span style="color:#f92672">=</span> True)<span style="color:#75715e"># filling Embarked missing values</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#f92672">.</span>info()
</code></pre></div><pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 891 entries, 0 to 890
Data columns (total 12 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   PassengerId  891 non-null    int64  
 1   Survived     891 non-null    int64  
 2   Pclass       891 non-null    int64  
 3   Name         891 non-null    object 
 4   Sex          891 non-null    object 
 5   Age          891 non-null    float64
 6   SibSp        891 non-null    int64  
 7   Parch        891 non-null    int64  
 8   Ticket       891 non-null    object 
 9   Fare         891 non-null    float64
 10  Cabin        204 non-null    object 
 11  Embarked     891 non-null    object 
dtypes: float64(2), int64(5), object(5)
memory usage: 83.7+ KB
</code></pre>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[<span style="color:#e6db74">&#34;Embarked&#34;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;Embarked&#34;</span>]<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#34;category&#34;</span>) <span style="color:#75715e">#converting Embarked column to categorical data type</span>
</code></pre></div><!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[<span style="color:#e6db74">&#34;Embarked&#34;</span>]<span style="color:#f92672">.</span>dtype <span style="color:#75715e"># checking type of embarked column</span>
</code></pre></div><pre><code>CategoricalDtype(categories=['C', 'Q', 'S'], ordered=False)
</code></pre>
<p>Let me divide the people in the ship into two i.e child or adult. With year less than 18 I consider being child while anything above 18 as adult. I&rsquo;ll use <!-- raw HTML omitted -->Age<!-- raw HTML omitted --> in dividing them and I&rsquo;ll create another column called <!-- raw HTML omitted -->Category<!-- raw HTML omitted --> to hold <!-- raw HTML omitted -->child<!-- raw HTML omitted --> and <!-- raw HTML omitted -->adult<!-- raw HTML omitted --> variables.</p>
<blockquote>
<p><strong>Note:</strong> Asumptions are based on my area of jurisdiction constitution stipulation as to who an adult and child should be according to number of years.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[<span style="color:#e6db74">&#39;Category&#39;</span>] <span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>cut(df[<span style="color:#e6db74">&#39;Age&#39;</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">80</span>], labels<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;child&#39;</span>, <span style="color:#e6db74">&#39;adult&#39;</span>]) <span style="color:#75715e">#creating category column</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#f92672">.</span>head()
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>Bingo!!! the <!-- raw HTML omitted -->Category<!-- raw HTML omitted --> column have been created with pandas <!-- raw HTML omitted -->.cut()<!-- raw HTML omitted --> method as shown in  the above table.</p>
<p>I&rsquo;ll also add a <!-- raw HTML omitted -->Family<!-- raw HTML omitted --> column where I&rsquo;ll take into consideration <!-- raw HTML omitted -->SibSp<!-- raw HTML omitted --> and <!-- raw HTML omitted -->Parch<!-- raw HTML omitted --> columns where I&rsquo;ll write an expresion where the two columns should be more than one.</p>
<blockquote>
<p><strong>Note:</strong> My assumption is for a family to be called a family,the number of siblings / spouses aboard the Titanic and number of parents / children aboard the Titanic	should be greater than zero.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[<span style="color:#e6db74">&#34;Family&#34;</span>] <span style="color:#f92672">=</span>(df[<span style="color:#e6db74">&#39;SibSp&#39;</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">&amp;</span> ([<span style="color:#e6db74">&#39;Parch&#39;</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>) <span style="color:#75715e">#creating family column</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#f92672">.</span>head()
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>Bingo!!! the <!-- raw HTML omitted -->Family<!-- raw HTML omitted --> column have been created with pandas <!-- raw HTML omitted -->.cut()<!-- raw HTML omitted --> method as shown in  the above table. 
I&rsquo;ll inspect the data frame to see if I have handled missing values and columns I&rsquo;ve created their data type.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#f92672">.</span>info()
</code></pre></div><pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 891 entries, 0 to 890
Data columns (total 14 columns):
 #   Column       Non-Null Count  Dtype   
---  ------       --------------  -----   
 0   PassengerId  891 non-null    int64   
 1   Survived     891 non-null    int64   
 2   Pclass       891 non-null    int64   
 3   Name         891 non-null    object  
 4   Sex          891 non-null    object  
 5   Age          891 non-null    float64 
 6   SibSp        891 non-null    int64   
 7   Parch        891 non-null    int64   
 8   Ticket       891 non-null    object  
 9   Fare         891 non-null    float64 
 10  Cabin        204 non-null    object  
 11  Embarked     891 non-null    category
 12  Category     891 non-null    category
 13  Family       891 non-null    bool    
dtypes: bool(1), category(2), float64(2), int64(5), object(4)
memory usage: 79.5+ KB
</code></pre>
<p>Let me inspect the uniqueness in each columns.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#f92672">.</span>nunique()
</code></pre></div><pre><code>PassengerId    891
Survived         2
Pclass           3
Name           891
Sex              2
Age             88
SibSp            7
Parch            7
Ticket         681
Fare           248
Cabin          147
Embarked         3
Category         2
Family           2
dtype: int64
</code></pre>
<p>Let me convert <!-- raw HTML omitted -->Family<!-- raw HTML omitted --> to categorical since it has two variables either <!-- raw HTML omitted -->True<!-- raw HTML omitted --> or <!-- raw HTML omitted -->False<!-- raw HTML omitted --> for <!-- raw HTML omitted -->Family<!-- raw HTML omitted --> and no <!-- raw HTML omitted -->Family<!-- raw HTML omitted --> respectively.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[<span style="color:#e6db74">&#34;Family&#34;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;Family&#34;</span>]<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#34;category&#34;</span>)<span style="color:#75715e"># converting family from bool to categorical</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#f92672">.</span>info()
</code></pre></div><pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 891 entries, 0 to 890
Data columns (total 14 columns):
 #   Column       Non-Null Count  Dtype   
---  ------       --------------  -----   
 0   PassengerId  891 non-null    int64   
 1   Survived     891 non-null    int64   
 2   Pclass       891 non-null    int64   
 3   Name         891 non-null    object  
 4   Sex          891 non-null    object  
 5   Age          891 non-null    float64 
 6   SibSp        891 non-null    int64   
 7   Parch        891 non-null    int64   
 8   Ticket       891 non-null    object  
 9   Fare         891 non-null    float64 
 10  Cabin        204 non-null    object  
 11  Embarked     891 non-null    category
 12  Category     891 non-null    category
 13  Family       891 non-null    category
dtypes: category(3), float64(2), int64(5), object(4)
memory usage: 79.6+ KB
</code></pre>
<p>Let me inspect the fare that was being paid by those who had family and those who didn&rsquo;t have in each station. Using below snippet of code.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df3 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([
    df<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#34;Family&#34;</span>,<span style="color:#e6db74">&#34;Embarked&#34;</span>])[<span style="color:#e6db74">&#34;Fare&#34;</span>]<span style="color:#f92672">.</span>mean()
], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
df3
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>It is evident from above that those who had family paid more than those who were alone in each station.
Let me include an <!-- raw HTML omitted -->adult<!-- raw HTML omitted --> and a <!-- raw HTML omitted -->child<!-- raw HTML omitted --> from <!-- raw HTML omitted -->Category<!-- raw HTML omitted --> column and <!-- raw HTML omitted -->Sex<!-- raw HTML omitted --> columm of <!-- raw HTML omitted -->Female<!-- raw HTML omitted --> and <!-- raw HTML omitted -->Male<!-- raw HTML omitted --> in each station and see who paid more in average.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df3 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([
    df<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#34;Category&#34;</span>,<span style="color:#e6db74">&#34;Sex&#34;</span>,<span style="color:#e6db74">&#34;Embarked&#34;</span>])[<span style="color:#e6db74">&#34;Fare&#34;</span>]<span style="color:#f92672">.</span>mean()
], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
df3
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>From above it is evident that females who are adults paid more than child who is female and a child of male gender from Cherbourg and Queenstown paid more than their adult counterpart.
Let me see how many were family member and between family and those who were single who died more.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df3 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([
    df<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#34;Family&#34;</span>,<span style="color:#e6db74">&#34;Pclass&#34;</span>,<span style="color:#e6db74">&#34;Survived&#34;</span>])[<span style="color:#e6db74">&#34;Survived&#34;</span>]<span style="color:#f92672">.</span>count()
], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
df3<span style="color:#f92672">.</span>columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;Count&#34;</span>]
df3

</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>From above it is evident that in first class <!-- raw HTML omitted -->20<!-- raw HTML omitted --> family members died and <!-- raw HTML omitted -->59<!-- raw HTML omitted --> survived while <!-- raw HTML omitted -->60<!-- raw HTML omitted --> who had no family died and <!-- raw HTML omitted -->77<!-- raw HTML omitted --> survived.In the second class <!-- raw HTML omitted -->27<!-- raw HTML omitted --> family members died while <!-- raw HTML omitted -->37<!-- raw HTML omitted --> survived while their counterpart <!-- raw HTML omitted -->70<!-- raw HTML omitted --> died while <!-- raw HTML omitted -->50<!-- raw HTML omitted --> survived lastly in the third class <!-- raw HTML omitted -->104<!-- raw HTML omitted --> family members died and <!-- raw HTML omitted -->36<!-- raw HTML omitted --> survived while those who had no family <!-- raw HTML omitted -->268<!-- raw HTML omitted --> died and <!-- raw HTML omitted -->83<!-- raw HTML omitted --> survived.</p>
<p>Let me inspect the <!-- raw HTML omitted -->Fare<!-- raw HTML omitted --> that those who were family members and singles paid.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df4 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([
    df<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#34;Family&#34;</span>,<span style="color:#e6db74">&#34;Pclass&#34;</span>])[<span style="color:#e6db74">&#34;Fare&#34;</span>]<span style="color:#f92672">.</span>mean()
], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)

df4
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>From above it is evident that family members(<!-- raw HTML omitted -->True<!-- raw HTML omitted -->) paid more than those who were single(<!-- raw HTML omitted -->False<!-- raw HTML omitted -->).</p>
<h1 id="213-data-visualization">2.1.3 Data Visualization.</h1>
<p>Let me draw a <!-- raw HTML omitted -->boxplot<!-- raw HTML omitted --> to show how people are distributed across the three classes in the ship using <!-- raw HTML omitted -->seaborn<!-- raw HTML omitted --> and <!-- raw HTML omitted -->matplotlib<!-- raw HTML omitted --> libraries .</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">6</span>));<span style="color:#75715e"># figure size</span>
sns<span style="color:#f92672">.</span>set(style<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;whitegrid&#34;</span>, color_codes<span style="color:#f92672">=</span>True) <span style="color:#75715e">#  background appearance </span>
sns<span style="color:#f92672">.</span>boxplot(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Pclass&#39;</span>,y<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Age&#39;</span>,data<span style="color:#f92672">=</span>df,palette<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Set1&#39;</span>); <span style="color:#75715e">#plotting boxplot</span>
</code></pre></div><p><img src="Titanic_Project_Final_files/Titanic_Project_Final_55_0.png" alt="png"></p>
<p>From above boxplot old boarded first class while childrens boarded third class.</p>
<p>Let me draw a countplot using seaborn library to see how adults and children distributed themselves among three classes.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">6</span>));<span style="color:#75715e"># size of graph</span>
sns<span style="color:#f92672">.</span>set_style(<span style="color:#e6db74">&#39;whitegrid&#39;</span>); <span style="color:#75715e"># background style</span>
sns<span style="color:#f92672">.</span>countplot(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Category&#39;</span>,data<span style="color:#f92672">=</span>df,hue<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Pclass&#34;</span>,palette<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Set1&#39;</span>); <span style="color:#75715e">#plotting countplot</span>

plt<span style="color:#f92672">.</span>legend(bbox_to_anchor<span style="color:#f92672">=</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>), loc<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,title<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Pclass&#34;</span> );<span style="color:#75715e">#locating legend</span>
</code></pre></div><p><img src="Titanic_Project_Final_files/Titanic_Project_Final_57_0.png" alt="png"></p>
<p>It is evident from above class that adults were more in all classes as compared to childrens.</p>
<p>Next let me draw a graph to see survival rate of both sex.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">6</span>));<span style="color:#75715e"># size of graph</span>
sns<span style="color:#f92672">.</span>set_style(<span style="color:#e6db74">&#39;whitegrid&#39;</span>);
sns<span style="color:#f92672">.</span>countplot(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Survived&#39;</span>,hue<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Sex&#39;</span>,data<span style="color:#f92672">=</span>df,palette<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Set1&#39;</span>);
plt<span style="color:#f92672">.</span>legend(bbox_to_anchor<span style="color:#f92672">=</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>), loc<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,title<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Sex&#34;</span> );<span style="color:#75715e">#locating legend</span>
</code></pre></div><p><img src="Titanic_Project_Final_files/Titanic_Project_Final_59_0.png" alt="png"></p>
<p>From above graph <!-- raw HTML omitted -->males<!-- raw HTML omitted --> died more than <!-- raw HTML omitted -->females<!-- raw HTML omitted --> whle <!-- raw HTML omitted -->female<!-- raw HTML omitted --> survived more than <!-- raw HTML omitted -->male<!-- raw HTML omitted -->.</p>
<p>Let me also show the survival rate in each class.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">6</span>));<span style="color:#75715e"># size of graph</span>
sns<span style="color:#f92672">.</span>set_style(<span style="color:#e6db74">&#39;whitegrid&#39;</span>)
sns<span style="color:#f92672">.</span>countplot(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Survived&#39;</span>,hue<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Pclass&#39;</span>,data<span style="color:#f92672">=</span>df,palette<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Set1&#39;</span>)
plt<span style="color:#f92672">.</span>legend(bbox_to_anchor<span style="color:#f92672">=</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>), loc<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,title<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Pclass&#34;</span> );<span style="color:#75715e">#locating legend</span>
</code></pre></div><p><img src="Titanic_Project_Final_files/Titanic_Project_Final_61_0.png" alt="png"></p>
<p>People in the first class survived more than the rest while people in third class died more than the rest.</p>
<p>Next let me see between children and adults who survived more.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">6</span>));<span style="color:#75715e"># size of graph</span>
sns<span style="color:#f92672">.</span>set_style(<span style="color:#e6db74">&#39;whitegrid&#39;</span>);
sns<span style="color:#f92672">.</span>countplot(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Survived&#39;</span>,hue<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Category&#39;</span>,data<span style="color:#f92672">=</span>df,palette<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Set1&#39;</span>);
plt<span style="color:#f92672">.</span>legend(bbox_to_anchor<span style="color:#f92672">=</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>), loc<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,title<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Category&#34;</span> );<span style="color:#75715e">#locating legend</span>
</code></pre></div><p><img src="Titanic_Project_Final_files/Titanic_Project_Final_63_0.png" alt="png"></p>
<p>In both scenarios more adults died and survived than childrens.</p>
<p>Next let me draw a histogram to see how fare is distributed.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">6</span>));<span style="color:#75715e"># size of graph</span>
df[<span style="color:#e6db74">&#39;Fare&#39;</span>]<span style="color:#f92672">.</span>hist(bins<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>,color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;darkred&#39;</span>,alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.7</span>);
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;Fare&#34;</span>);
</code></pre></div><p><img src="Titanic_Project_Final_files/Titanic_Project_Final_65_0.png" alt="png"></p>
<p>From above it is evident that Fare is not normal distributed and it needs to be standardized.</p>
<p>Next let me see how the Number of siblings / spouses who aboarded the Titanic are distributed.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">6</span>));<span style="color:#75715e"># size of graph</span>
sns<span style="color:#f92672">.</span>countplot(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;SibSp&#39;</span>,hue<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Pclass&#34;</span>,palette<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Set1&#34;</span>,data<span style="color:#f92672">=</span>df);
plt<span style="color:#f92672">.</span>legend(bbox_to_anchor<span style="color:#f92672">=</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>), loc<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,title<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Pclass&#34;</span> );<span style="color:#75715e">#locating legend</span>
</code></pre></div><p><img src="Titanic_Project_Final_files/Titanic_Project_Final_67_0.png" alt="png"></p>
<p>Fro above it is evident those who were single with no sibling and spouses were more than the rest in all classes in the Titanic.</p>
<p>Next let me see how the number of parents / children who aboard the Titanic are distributed.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">6</span>));<span style="color:#75715e"># size of graph</span>
sns<span style="color:#f92672">.</span>countplot(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Parch&#39;</span>,hue<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Pclass&#34;</span>,palette<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Set1&#34;</span>,data<span style="color:#f92672">=</span>df);
plt<span style="color:#f92672">.</span>legend(bbox_to_anchor<span style="color:#f92672">=</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>), loc<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,title<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Pclass&#34;</span> );<span style="color:#75715e">#locating legend</span>
</code></pre></div><p><img src="Titanic_Project_Final_files/Titanic_Project_Final_69_0.png" alt="png"></p>
<p>From above it is evident that those who had 0 number of parents/children in the Titanic were more than the rest.</p>
<p>Next let me see if there is a correlation between different variables.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">6</span>));<span style="color:#75715e"># size of graph</span>
sns<span style="color:#f92672">.</span>set_style(<span style="color:#e6db74">&#39;whitegrid&#39;</span>); <span style="color:#75715e"># background style</span>
sns<span style="color:#f92672">.</span>heatmap(df<span style="color:#f92672">.</span>corr(), annot<span style="color:#f92672">=</span>True);
</code></pre></div><p><img src="Titanic_Project_Final_files/Titanic_Project_Final_71_0.png" alt="png"></p>
<p>From above the correlation between different column is minimal.</p>
<h1 id="3-machine-learning">3. MACHINE LEARNING.</h1>
<h2 id="31-feature-engineering">3.1 Feature Engineering.</h2>
<p>Before dividing the data into features and labels I&rsquo;ll drop <!-- raw HTML omitted -->Cabin<!-- raw HTML omitted --> column since its less important and it has a lot of missing variables, I&rsquo;ll set <!-- raw HTML omitted -->inplace<!-- raw HTML omitted --> to <!-- raw HTML omitted -->True<!-- raw HTML omitted --> so that it si compltetely removed from the dataframe.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#dropping the Cabin column</span>
df<span style="color:#f92672">.</span>drop(<span style="color:#e6db74">&#39;Cabin&#39;</span>,axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,inplace<span style="color:#f92672">=</span>True)
</code></pre></div><p>Let me see if the Cabin column has been removed by viewing the first few rows using .head() method.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#printing first four values.</span>
df<span style="color:#f92672">.</span>head()
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#info about column and data</span>
df<span style="color:#f92672">.</span>info()
</code></pre></div><pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 891 entries, 0 to 890
Data columns (total 13 columns):
 #   Column       Non-Null Count  Dtype   
---  ------       --------------  -----   
 0   PassengerId  891 non-null    int64   
 1   Survived     891 non-null    int64   
 2   Pclass       891 non-null    int64   
 3   Name         891 non-null    object  
 4   Sex          891 non-null    object  
 5   Age          891 non-null    float64 
 6   SibSp        891 non-null    int64   
 7   Parch        891 non-null    int64   
 8   Ticket       891 non-null    object  
 9   Fare         891 non-null    float64 
 10  Embarked     891 non-null    category
 11  Category     891 non-null    category
 12  Family       891 non-null    category
dtypes: category(3), float64(2), int64(5), object(3)
memory usage: 72.6+ KB
</code></pre>
<p>From above I can see I don&rsquo;t have any missing values then my data is ready for further engineering and modelling</p>
<h2 id="311-converting-categorical-features">3.1.1 Converting Categorical Features.</h2>
<p>I&rsquo;ll need to convert categorical features to dummy variables using pandas! Otherwise our machine learning algorithm won&rsquo;t be able to directly take in those features as inputs.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Converting  the categorical variables to dummy variables</span>
sex <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>get_dummies(df[<span style="color:#e6db74">&#39;Sex&#39;</span>],drop_first<span style="color:#f92672">=</span>True)
embark <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>get_dummies(df[<span style="color:#e6db74">&#39;Embarked&#39;</span>],drop_first<span style="color:#f92672">=</span>True)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#f92672">.</span>drop([<span style="color:#e6db74">&#39;Sex&#39;</span>,<span style="color:#e6db74">&#39;Embarked&#39;</span>,<span style="color:#e6db74">&#39;Name&#39;</span>,<span style="color:#e6db74">&#39;Category&#39;</span>,<span style="color:#e6db74">&#39;Family&#39;</span>,<span style="color:#e6db74">&#39;Ticket&#39;</span>],axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,inplace<span style="color:#f92672">=</span>True)
</code></pre></div><p>I&rsquo;ll return the <!-- raw HTML omitted -->Sex<!-- raw HTML omitted --> and <!-- raw HTML omitted -->Embarked<!-- raw HTML omitted --> column that I had dropped durring encoding stage using a method called concat() from pandas library</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"> <span style="color:#75715e">#concatinating sex and embark column to data</span>
df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([df,sex,embark],axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#printing first four rows</span>
df<span style="color:#f92672">.</span>head()
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>Infering my  few rows of data I can see I have my data in numerical form for my model to work best.</p>
<p>Before I build the model I&rsquo;ll have to split  data into features and labels i.e X and y.</p>
<p>After splitting  data into X and y i&rsquo;ll further split into training set and test set whereby i&rsquo;ll use training set to train the model and also use it in evaluation stage in the process of developing the model.</p>
<p>I&rsquo;ll use the trained model to predict the model using the unseen test set whereby it will help in assessing how the model is performing and also its robustness.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Preparing the X  and y variables.</span>
X <span style="color:#f92672">=</span> df[[<span style="color:#e6db74">&#39;PassengerId&#39;</span>, <span style="color:#e6db74">&#39;Pclass&#39;</span>, <span style="color:#e6db74">&#39;Age&#39;</span>, <span style="color:#e6db74">&#39;SibSp&#39;</span>, <span style="color:#e6db74">&#39;Parch&#39;</span>, <span style="color:#e6db74">&#39;Fare&#39;</span>,
       <span style="color:#e6db74">&#39;male&#39;</span>, <span style="color:#e6db74">&#39;Q&#39;</span>, <span style="color:#e6db74">&#39;S&#39;</span>]]
y <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#34;Survived&#34;</span>]
</code></pre></div><p>From <!-- raw HTML omitted -->sklearn<!-- raw HTML omitted --> package I&rsquo;ll use a module called <!-- raw HTML omitted -->model_selection<!-- raw HTML omitted --> which has a function called <!-- raw HTML omitted -->train_test_split()<!-- raw HTML omitted --> which divides the data into training and test set.</p>
<p>In the <!-- raw HTML omitted -->train_test_split()<!-- raw HTML omitted --> function I have to pass features and labels and also split my data using <!-- raw HTML omitted -->test_size<!-- raw HTML omitted --> argument whereby I&rsquo;ll set it to 30% meaning  30% of my data will be used as test set while rest as traing set.</p>
<p>I&rsquo;ll set my <!-- raw HTML omitted -->random_state<!-- raw HTML omitted --> to 101 for reproducibility purposes.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#loading library and function</span>
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Splitting the data into train and test sets.</span>
X_train, X_test, y_train, y_test <span style="color:#f92672">=</span> train_test_split(X, y, test_size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.30</span>, 
                                                    random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">101</span>)
</code></pre></div><h2 id="32-building-and-evaluating-model">3.2 Building and Evaluating Model.</h2>
<p>Since our task at hand has labelled data and also predicted data is known so it fall under supervised typer of machine learning.</p>
<p>Under supervised machine learning it is divided into two classification and regression type. Classification answers the question of the form yes/no  and regession answers the questions how much?.</p>
<p>Since my task at hand is to predict whether a persion died or survived so it falls under classication problem and under classification i&rsquo;ll use below machine learning algorithms in training my model which are available in sklearn package read more about them in this link <a href="http://scikit-learn.org/stable/supervised_learning.html"><code>scikit-learn</code></a>.</p>
<ul>
<li>Gaussian Naive Bayes (GaussianNB).</li>
<li>Decision Trees.</li>
<li>Ensemble Methods (Bagging, AdaBoost, Random Forest, Gradient Boosting).</li>
<li>K-Nearest Neighbors (KNeighbors).</li>
<li>Support Vector Machines (SVM).</li>
<li>Logistic Regression.</li>
</ul>
<h3 id="321-implementation">3.2.1 Implementation.</h3>
<p>I&rsquo;ll implement my model using the following procedure in each algorithm.</p>
<ul>
<li>I&rsquo;ll start by importing the module</li>
<li>Next I&rsquo;ll initialize the module using the classifier.</li>
<li>After that train the model by fitting it to my data using <!-- raw HTML omitted -->.fit()<!-- raw HTML omitted --> method.</li>
<li>I&rsquo;ll use trained model to make prediction using <!-- raw HTML omitted -->predict()<!-- raw HTML omitted --> function.The predict() function will return an array of prediction for each data instance in test set.</li>
</ul>
<h1 id="330-building-a-logistic-regression-model">3.3.0 Building a Logistic Regression model.</h1>
<p>Logistic regression is a type of regression where its class variable is not continous but categorical, as our cas to survival rate where it is categorical with two classes.Since I&rsquo;m dealing with binary classification problem I&rsquo;ll use binomial logistic regression, which is of this form 
$$ Y =  \frac{e^x}{1+e^x}  $$<br>
$$ where\ X = B_0 + B{_1}x $$</p>
<p>I had imported the Logistic classifier in the beggining of this project what I&rsquo;ll do is to initialize the classifier then fit in the model using <strong>.fit method</strong></p>
<blockquote>
<p><strong>Step 1</strong>: First I&rsquo;ll <code>import</code> the models from <code>sklearn</code> and use it to instatiate the class.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Importing the LogisticRegression Classifier</span>
<span style="color:#f92672">from</span> sklearn.linear_model <span style="color:#f92672">import</span> LogisticRegression
</code></pre></div><blockquote>
<p><strong>Step 2:</strong> Now that I  have imported each of the classifiers, I&rsquo;ll <code>instantiate</code> the classifier as below.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># instatiating the classifier.</span>
logmodel <span style="color:#f92672">=</span> LogisticRegression()
</code></pre></div><blockquote>
<p><strong>Step 3:</strong> Now that I have instantiated the model, I&rsquo;ll <code>fit</code> it using the <strong>X_train</strong> and <strong>y_train</strong>.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Fitting your LogisticRegression class to the training data</span>
logmodel<span style="color:#f92672">.</span>fit(X_train,y_train)
</code></pre></div><pre><code>LogisticRegression(C=1.0, class_weight=None, dual=False, fit_intercept=True,
                   intercept_scaling=1, l1_ratio=None, max_iter=100,
                   multi_class='auto', n_jobs=None, penalty='l2',
                   random_state=None, solver='lbfgs', tol=0.0001, verbose=0,
                   warm_start=False)
</code></pre>
<blockquote>
<p><strong>Step 4:</strong> Now that I have fit  the model, I will use it to <code>predict</code> on the <strong>testing_data</strong>.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Predicting using LogisticRegression on the test data</span>
predictions_log <span style="color:#f92672">=</span> logmodel<span style="color:#f92672">.</span>predict(X_test)
</code></pre></div><blockquote>
<p><strong>Step 5:</strong> Now that I have made the predictions, I&rsquo;ll compare the predictions to the actual values using the function below for  the model - this will give  the <code>score</code> for how well  the model is performing.</p>
</blockquote>
<h3 id="331-metrics-for-evaluating-model-performance">3.3.1 Metrics for Evaluating Model Performance.</h3>
<p>Let me define metrics that ill use in evaluating my model accurcy.</p>
<ul>
<li>
<p><strong>True Positive (TP)</strong>: Correctly classified as the class of interest.</p>
</li>
<li>
<p><strong>True Negative (TN)</strong>: Correctly classified as not the class of interest.</p>
</li>
<li>
<p><strong>False Positive (FP)</strong>: Incorrectly classified as the class of interest.</p>
</li>
<li>
<p><strong>False Negative (FN)</strong>: Incorrectly classified as not the class of interest.</p>
</li>
<li>
<p><strong>Accuracy</strong> : The proportion of correct predictions out of all the predictions given by:</p>
</li>
</ul>
<p>$$ Accurcy  =  \frac{TP + TN}{TP + FP + TN  + FN} $$</p>
<ul>
<li>
<p><strong>Precision</strong> (also known as the positive predictive value) is defined as the proportion of positive examples that are truly positive, given by the formula:
$$ Precision = \frac{TP}{TP + FP}  $$</p>
</li>
<li>
<p><strong>Recall</strong>: This is defined as the number of true positives over the total number of positives, given by:
$$ Recall = \frac{Tp}{TP + FN}$$</p>
</li>
<li>
<p><strong>F1 score</strong>: It combines precision and recall using <strong>harmonic mean</strong> also known as <strong>F-measure</strong> or <strong>F-score</strong>, iven by:
$$ F-MEASURE = \frac{2 \cdot precision \cdot recall}{recall + precision} = \frac{2 \cdot TP }{2 \cdot TP + FP + FN}$$</p>
</li>
<li>
<p><strong>Confusion matrix</strong>: This is a <strong>n x n</strong>  matrix that is used to compare predicted values to actual values.As shown below.
<!-- raw HTML omitted --></p>
</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">model_metrics</span>(y_true, preds, model_name<span style="color:#f92672">=</span>None):
    <span style="color:#e6db74">&#39;&#39;&#39;
</span><span style="color:#e6db74">    INPUT:
</span><span style="color:#e6db74">    y_true - the y values that are actually true in the dataset (numpy array or pandas series)
</span><span style="color:#e6db74">    preds - the predictions for those values from some model (numpy array or pandas series)
</span><span style="color:#e6db74">    model_name - (str - optional) a name associated with the model if you would like to add it to the print statements 
</span><span style="color:#e6db74">    
</span><span style="color:#e6db74">    OUTPUT:
</span><span style="color:#e6db74">    None - prints the accuracy, precision, recall, and F1 score
</span><span style="color:#e6db74">    &#39;&#39;&#39;</span>
    <span style="color:#66d9ef">if</span> model_name <span style="color:#f92672">==</span> None:
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Accuracy score for : &#39;</span>, format(accuracy_score(y_true, preds)))
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Precision score for : &#39;</span>, format(precision_score(y_true, preds)))
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Recall score for : &#39;</span>, format(recall_score(y_true, preds)))
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;F1 score for: &#39;</span>, format(f1_score(y_true, preds)))
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#39;</span>)
    
    <span style="color:#66d9ef">else</span>:
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Accuracy score for &#39;</span> <span style="color:#f92672">+</span> model_name <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39; :&#39;</span> , format(accuracy_score(y_true, preds)))
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Precision score for &#39;</span> <span style="color:#f92672">+</span> model_name <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39; :&#39;</span>, format(precision_score(y_true, preds)))
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Recall score for &#39;</span> <span style="color:#f92672">+</span> model_name <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39; :&#39;</span>, format(recall_score(y_true, preds)))
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;F1 score for &#39;</span> <span style="color:#f92672">+</span> model_name <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39; :&#39;</span>, format(f1_score(y_true, preds)))
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#39;</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Printing Logistic scores</span>
model_metrics(y_test, predictions_log, <span style="color:#e6db74">&#39;LOGISTIC&#39;</span>)
</code></pre></div><pre><code>Accuracy score for LOGISTIC : 0.7686567164179104
Precision score for LOGISTIC : 0.782608695652174
Recall score for LOGISTIC : 0.631578947368421
F1 score for LOGISTIC : 0.6990291262135923
</code></pre>
<p>From above it&rsquo;s evident that the <strong>Logistic regession</strong> has an <strong>accuracy</strong> of <strong>77%</strong> with <strong>precision</strong> rate being <strong>78%</strong> while <strong>recall</strong> score being <strong>63%</strong> and <strong>f1</strong> score as <strong>70%</strong>.</p>
<p>Next I&rsquo;ll use below code snippet in coming up with <strong>confusion matrix</strong> and make deduction on how the features have been predicted.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> confusion_matrix

<span style="color:#66d9ef">for</span> m, model <span style="color:#f92672">in</span> enumerate([logmodel]):
    confusion_mat<span style="color:#f92672">=</span> confusion_matrix(y_test, model<span style="color:#f92672">.</span>predict(X_test))
    confusion_mat<span style="color:#f92672">=</span> confusion_mat<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;float&#39;</span>) <span style="color:#f92672">/</span> confusion_mat<span style="color:#f92672">.</span>sum(axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)[:, np<span style="color:#f92672">.</span>newaxis] <span style="color:#75715e"># normalizing the data</span>

    <span style="color:#75715e"># Plotting the heatmap</span>
    plt<span style="color:#f92672">.</span>figure(m)
    sns<span style="color:#f92672">.</span>heatmap(confusion_mat, annot<span style="color:#f92672">=</span>True, annot_kws<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;size&#34;</span>:<span style="color:#ae81ff">30</span>}, cmap<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Reds&#39;</span>, square<span style="color:#f92672">=</span>True, fmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;.3f&#39;</span>)
    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;True label&#39;</span>,fontdict<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;size&#34;</span>:<span style="color:#ae81ff">14</span>})
    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Predicted label&#39;</span>,fontdict<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;size&#34;</span>:<span style="color:#ae81ff">14</span>})
    plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Confusion matrix for:</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">{}&#39;</span><span style="color:#f92672">.</span>format(model<span style="color:#f92672">.</span>__class__<span style="color:#f92672">.</span>__name__),fontdict<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;size&#34;</span>:<span style="color:#ae81ff">14</span>});
</code></pre></div><p><img src="Titanic_Project_Final_files/Titanic_Project_Final_109_0.png" alt="png"></p>
<p>From above <strong>87%</strong> of the labels was correctly predicted as <strong>death</strong> and <strong>63%</strong> as <strong>survived</strong> while <strong>37%</strong> of the <strong>survived</strong> label was predicted incorrectly and <strong>13%</strong> of death labels were misclassified as <strong>survived</strong>.</p>
<h1 id="34-building-a-knn-model">3.4 Building a KNN model.</h1>
<p>This method is called lazy learning because parameters for modelling purposes is not defined.For new data point prediction, the train data is searched for an instance resembling the new instance to be predicted.During modelling purposes the training themselves conjures the knowledge.In determining the proper class during modelling phace KNN looks for the closest points-the nearest neighbors.In order to determine the neighbors to be modelled by algorithm the k comes into play, for example if k=6, six nearest neighbors will be examined.IThe weakness of the algorithm is of equal weight attached traning all the six points even if some of them are meaningless.</p>
<blockquote>
<p><strong>Step 1</strong>: First I&rsquo;ll <code>import</code> the model from <code>sklearn</code> and use it to instatiate the class.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Import the KNeighbors Classifier</span>
<span style="color:#f92672">from</span> sklearn.neighbors <span style="color:#f92672">import</span> KNeighborsClassifier
</code></pre></div><blockquote>
<p><strong>Step 2:</strong> Now that I  have imported each of the classifiers, I&rsquo;ll <code>instantiate</code> the classifier.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Instantiate a KNeighborsClassifier with:</span>
<span style="color:#75715e"># n_neighbors=1 and everything else as default values</span>
mod_knn <span style="color:#f92672">=</span> KNeighborsClassifier(n_neighbors<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</code></pre></div><blockquote>
<p><strong>Step 3:</strong> Now that I have instantiated the model, I&rsquo;ll <code>fit</code> it using the <strong>X_train</strong> and <strong>y_train</strong>.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Fitting your KNeighborsClassifier to the training data</span>
mod_knn<span style="color:#f92672">.</span>fit(X_train,y_train)
</code></pre></div><pre><code>KNeighborsClassifier(algorithm='auto', leaf_size=30, metric='minkowski',
                     metric_params=None, n_jobs=None, n_neighbors=1, p=2,
                     weights='uniform')
</code></pre>
<blockquote>
<p><strong>Step 4:</strong> Now that I have fit  the model, I will use it to <code>predict</code> on the <strong>testing_data</strong>.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Predicting using KNeighborsClassifier on the test data</span>
preds_knn <span style="color:#f92672">=</span> mod_knn<span style="color:#f92672">.</span>predict(X_test)
</code></pre></div><blockquote>
<p><strong>Step 5:</strong> Now that I have made the predictions, I&rsquo;ll compare the predictions to the actual values using the function below for  the model .This will give  the <code>score</code> for how well  the model is performing.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Printing KNeighbors scores</span>
model_metrics(y_test, preds_knn, <span style="color:#e6db74">&#39;KNN&#39;</span>)
</code></pre></div><pre><code>Accuracy score for KNN : 0.5932835820895522
Precision score for KNN : 0.5242718446601942
Recall score for KNN : 0.47368421052631576
F1 score for KNN : 0.4976958525345622
</code></pre>
<p>From above it&rsquo;s evident that the <strong>KNeighbors</strong> has an <strong>accuracy</strong> of <strong>59%</strong> with <strong>precision</strong> rate being <strong>52%</strong> while <strong>recall</strong> score being <strong>47%</strong> and <strong>f1</strong> score as <strong>50%</strong>.</p>
<p>Next I&rsquo;ll use below code snippet in coming up with confusion matrix and make deduction on how the features have been predicted.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> confusion_matrix

<span style="color:#66d9ef">for</span> m, model <span style="color:#f92672">in</span> enumerate([mod_knn]):
    confusion_mat<span style="color:#f92672">=</span> confusion_matrix(y_test, model<span style="color:#f92672">.</span>predict(X_test))
    confusion_mat<span style="color:#f92672">=</span> confusion_mat<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;float&#39;</span>) <span style="color:#f92672">/</span> confusion_mat<span style="color:#f92672">.</span>sum(axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)[:, np<span style="color:#f92672">.</span>newaxis] <span style="color:#75715e"># normalizing the data</span>

    <span style="color:#75715e"># Plot the heatmap</span>
    plt<span style="color:#f92672">.</span>figure(m)
    sns<span style="color:#f92672">.</span>heatmap(confusion_mat, annot<span style="color:#f92672">=</span>True, annot_kws<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;size&#34;</span>:<span style="color:#ae81ff">30</span>}, cmap<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Reds&#39;</span>, square<span style="color:#f92672">=</span>True, fmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;.3f&#39;</span>)
    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;True label&#39;</span>,fontdict<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;size&#34;</span>:<span style="color:#ae81ff">14</span>})
    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Predicted label&#39;</span>,fontdict<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;size&#34;</span>:<span style="color:#ae81ff">14</span>})
    plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Confusion matrix for:</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">{}&#39;</span><span style="color:#f92672">.</span>format(model<span style="color:#f92672">.</span>__class__<span style="color:#f92672">.</span>__name__),fontdict<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;size&#34;</span>:<span style="color:#ae81ff">14</span>});
</code></pre></div><p><img src="Titanic_Project_Final_files/Titanic_Project_Final_123_0.png" alt="png"></p>
<p>From above <strong>68%</strong> of the labels was correctly predicted as <strong>death</strong> and <strong>47%</strong> as <strong>survived</strong> while <strong>52%</strong> of the <strong>survived</strong> label was predicted incorrectly and <strong>31%</strong> of death labels were misclassified as <strong>survived</strong>.</p>
<h1 id="35-building-a-decision-tree-model">3.5 Building a DECISION TREE model.</h1>
<p>A decision tree works by generating a separating hyperplane or a threshold for the features in data. It does this by considering every feature and finding the correlation between the spread of the values in that feature and the label that you are trying to predict.</p>
<blockquote>
<p><strong>Step 1</strong>: First I&rsquo;ll <code>import</code> the model from <code>sklearn</code> and use it to instatiate the class.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Importing the  DecisionTree Classifier</span>
<span style="color:#f92672">from</span> sklearn.tree <span style="color:#f92672">import</span> DecisionTreeClassifier
</code></pre></div><blockquote>
<p><strong>Step 2:</strong> Now that I  have imported each of the classifiers, I&rsquo;ll <code>instantiate</code> the classifier.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Instantiating a DecisionTreeClassifier</span>
mod_tree <span style="color:#f92672">=</span> DecisionTreeClassifier()
</code></pre></div><blockquote>
<p><strong>Step 3:</strong> Now that I have instantiated the model, I&rsquo;ll <code>fit</code> it using the <strong>X_train</strong> and <strong>y_train</strong>.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Fiting your DecisionTreeClassifier to the training data</span>
mod_tree<span style="color:#f92672">.</span>fit(X_train,y_train)
</code></pre></div><pre><code>DecisionTreeClassifier(ccp_alpha=0.0, class_weight=None, criterion='gini',
                       max_depth=None, max_features=None, max_leaf_nodes=None,
                       min_impurity_decrease=0.0, min_impurity_split=None,
                       min_samples_leaf=1, min_samples_split=2,
                       min_weight_fraction_leaf=0.0, presort='deprecated',
                       random_state=None, splitter='best')
</code></pre>
<blockquote>
<p><strong>Step 4:</strong> Now that I have fit  the model, I will use it to <code>predict</code> on the <strong>testing_data</strong>.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Predicting  using DecisionTreeClassifie on the test data</span>
predictions_tree <span style="color:#f92672">=</span> mod_tree<span style="color:#f92672">.</span>predict(X_test)
</code></pre></div><blockquote>
<p><strong>Step 5:</strong> Now that I have made the predictions, I&rsquo;ll compare the predictions to the actual values using the function below for  the model . This will give  the <code>score</code> for how well  the model is performing.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Printing the Decision Tree classifier.</span>
model_metrics(y_test, predictions_tree, <span style="color:#e6db74">&#39;Decision Tree&#39;</span>)
</code></pre></div><pre><code>Accuracy score for Decision Tree : 0.7388059701492538
Precision score for Decision Tree : 0.7340425531914894
Recall score for Decision Tree : 0.6052631578947368
F1 score for Decision Tree : 0.6634615384615384
</code></pre>
<p>From above it&rsquo;s evident that the <strong>Decision Tree</strong> has an <strong>accuracy</strong> of <strong>74%</strong> with <strong>precision</strong> rate being <strong>783%</strong> while <strong>recall</strong> score being <strong>61%</strong> and <strong>f1</strong> score as <strong>66%</strong>.</p>
<p>Next I&rsquo;ll use below code snippet in coming up with confusion matrix and make deduction on how the features have been predicted.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> confusion_matrix

<span style="color:#66d9ef">for</span> m, model <span style="color:#f92672">in</span> enumerate([mod_tree]):
    confusion_mat<span style="color:#f92672">=</span> confusion_matrix(y_test, model<span style="color:#f92672">.</span>predict(X_test))
    confusion_mat<span style="color:#f92672">=</span> confusion_mat<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;float&#39;</span>) <span style="color:#f92672">/</span> confusion_mat<span style="color:#f92672">.</span>sum(axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)[:, np<span style="color:#f92672">.</span>newaxis] <span style="color:#75715e"># normalizing the data</span>

    <span style="color:#75715e"># Plot the heatmap</span>
    plt<span style="color:#f92672">.</span>figure(m)
    sns<span style="color:#f92672">.</span>heatmap(confusion_mat, annot<span style="color:#f92672">=</span>True, annot_kws<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;size&#34;</span>:<span style="color:#ae81ff">30</span>}, cmap<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Reds&#39;</span>, square<span style="color:#f92672">=</span>True, fmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;.3f&#39;</span>)
    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;True label&#39;</span>,fontdict<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;size&#34;</span>:<span style="color:#ae81ff">14</span>})
    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Predicted label&#39;</span>,fontdict<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;size&#34;</span>:<span style="color:#ae81ff">14</span>})
    plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Confusion matrix for:</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">{}&#39;</span><span style="color:#f92672">.</span>format(model<span style="color:#f92672">.</span>__class__<span style="color:#f92672">.</span>__name__),fontdict<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;size&#34;</span>:<span style="color:#ae81ff">14</span>});
</code></pre></div><p><img src="Titanic_Project_Final_files/Titanic_Project_Final_137_0.png" alt="png"></p>
<p>From above <strong>83%</strong> of the labels was correctly predicted as <strong>death</strong> and <strong>61%</strong> as <strong>survived</strong> while <strong>40%</strong> of the <strong>survived</strong> label was predicted incorrectly and <strong>16%</strong> of death labels were misclassified as <strong>survived</strong>.</p>
<h1 id="36-building-support-vector-model">3.6 Building Support Vector Model.</h1>
<p>Support vector is like a points of plotted in multidimensional expessing values and their examples.The support vector machine(SVM) creates a boundary called hyperplane, which divides the space creating homogeneous partition on either side, hence combining Nearest Neighbor and Linear Regression methods.SVM uses the idea of what is known as Maximum Marginal Hyperplane which create greater separation between two classes.Kernel Trick is also applied in seperating the two classes.</p>
<p>Some of the kernel trick applied include:
Kernell function takes this form:
<!-- raw HTML omitted --> 
where Greek letter phi, that is, ϕ(x), is a mapping of the data into another space. Therefore,  the general kernel function applies some transformation to the feature vectors xi and 
xj and combines them using the dot product, which takes two vectors and returns a  single number.</p>
<ol>
<li>
<p>linear kernel which does not transform data at all, given by the formula:
<!-- raw HTML omitted --></p>
</li>
<li>
<p>Polynomial kernel of degree d which adds a simple nonlinear transformation of data.
<!-- raw HTML omitted --></p>
</li>
<li>
<p>Sigmoid Kernel: Is almost like sigmoid activation function used in neural network.Given by the formula.
<!-- raw HTML omitted --></p>
</li>
<li>
<p>Gaussian RBF Kernel which is anologous to RBF neural network.It does well in many types of data.
<!-- raw HTML omitted --></p>
</li>
</ol>
<p>First I&rsquo;ll load the package necessary for the modelling from <strong>sklearn</strong> where it has a method called <strong>svm</strong> which has <strong>SVC</strong> function embedded for training support vector machine modells as below.</p>
<blockquote>
<p><strong>Step 1</strong>: First I&rsquo;ll <code>import</code> the model from <code>sklearn</code> and use it to instatiate the class.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> sklearn.svm <span style="color:#f92672">import</span> SVC <span style="color:#75715e">#loading library necessary for modelling</span>
</code></pre></div><blockquote>
<p><strong>Step 2:</strong> Now that I  have imported each of the classifiers, I&rsquo;ll <code>instantiate</code> the classifier.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">model_svc <span style="color:#f92672">=</span> SVC() <span style="color:#75715e">#instatiate the model</span>
</code></pre></div><blockquote>
<p><strong>Step 3:</strong> Now that I have instantiated the model, I&rsquo;ll <code>fit</code> it using the <strong>X_train</strong> and <strong>y_train</strong>.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">model_svc<span style="color:#f92672">.</span>fit(X_train,y_train) <span style="color:#75715e">#fitting trained model</span>
</code></pre></div><pre><code>SVC(C=1.0, break_ties=False, cache_size=200, class_weight=None, coef0=0.0,
    decision_function_shape='ovr', degree=3, gamma='scale', kernel='rbf',
    max_iter=-1, probability=False, random_state=None, shrinking=True,
    tol=0.001, verbose=False)
</code></pre>
<blockquote>
<p><strong>Step 4:</strong> Now that I have fit  the model, I will use it to <code>predict</code> on the <strong>testing_data</strong>.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">predictions_svm <span style="color:#f92672">=</span> model_svc<span style="color:#f92672">.</span>predict(X_test) <span style="color:#75715e">#predicting the feature labels</span>
</code></pre></div><blockquote>
<p><strong>Step 5:</strong> Now that I have made the predictions, I&rsquo;ll compare the predictions to the actual values using the function below for  the model . This will give  the <code>score</code> for how well  the model is performing.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Printing Support Vector Machine scores.</span>
model_metrics(y_test, predictions_svm, <span style="color:#e6db74">&#39;Support Vector Machine&#39;</span>)
</code></pre></div><pre><code>Accuracy score for Support Vector Machine : 0.6044776119402985
Precision score for Support Vector Machine : 0.75
Recall score for Support Vector Machine : 0.10526315789473684
F1 score for Support Vector Machine : 0.1846153846153846
</code></pre>
<p>From above it&rsquo;s evident that the <strong>Support Vector Machine</strong>  has an <strong>accuracy</strong> of <strong>60%</strong> with <strong>precision</strong> rate being <strong>75%</strong> while <strong>recall</strong> score being <strong>11%</strong> and <strong>f1</strong> score as <strong>18%</strong>.</p>
<p>Next I&rsquo;ll use below code snippet in coming up with confusion matrix and make deduction on how the features have been predicted.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> confusion_matrix

<span style="color:#66d9ef">for</span> m, model <span style="color:#f92672">in</span> enumerate([model_svc]):
    confusion_mat<span style="color:#f92672">=</span> confusion_matrix(y_test, model<span style="color:#f92672">.</span>predict(X_test))
    confusion_mat<span style="color:#f92672">=</span> confusion_mat<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;float&#39;</span>) <span style="color:#f92672">/</span> confusion_mat<span style="color:#f92672">.</span>sum(axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)[:, np<span style="color:#f92672">.</span>newaxis] <span style="color:#75715e"># normalizing the data</span>

    <span style="color:#75715e"># Plot the heatmap</span>
    plt<span style="color:#f92672">.</span>figure(m)
    sns<span style="color:#f92672">.</span>heatmap(confusion_mat, annot<span style="color:#f92672">=</span>True, annot_kws<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;size&#34;</span>:<span style="color:#ae81ff">30</span>}, cmap<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Reds&#39;</span>, square<span style="color:#f92672">=</span>True, fmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;.3f&#39;</span>)
    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;True label&#39;</span>,fontdict<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;size&#34;</span>:<span style="color:#ae81ff">14</span>})
    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Predicted label&#39;</span>,fontdict<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;size&#34;</span>:<span style="color:#ae81ff">14</span>})
    plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Confusion matrix for:</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">{}&#39;</span><span style="color:#f92672">.</span>format(model<span style="color:#f92672">.</span>__class__<span style="color:#f92672">.</span>__name__),fontdict<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;size&#34;</span>:<span style="color:#ae81ff">14</span>});
</code></pre></div><p><img src="Titanic_Project_Final_files/Titanic_Project_Final_151_0.png" alt="png"></p>
<p>From above <strong>97%</strong> of the labels was correctly predicted as <strong>death</strong> and <strong>11%</strong> as <strong>survived</strong> while <strong>90%</strong> of the <strong>survived</strong> label was predicted incorrectly and <strong>3%</strong> of death labels were misclassified as <strong>survived</strong>.</p>
<p>Next I&rsquo;ll use ensemble type of classification in modelling the classification problem at hand and see if there will be some improvement on perfomance of the model</p>
<h1 id="36-ensemble-learning-model">3.6 Ensemble Learning Model.</h1>
<p>Ensemble learning, as the name denotes, is a method that combines several machine learning models to generate a superior model, thereby decreasing variability/variance and bias, and boosting performance, as shown below.
<!-- raw HTML omitted --></p>
<p>Ensemble models combine many weaker models that differ in variance and bias, thereby creating a better model, outperforming the individual weaker models.</p>
<!-- raw HTML omitted -->
<p>In  modelling  the  ensemble  learning  type  of  classification  I&rsquo;ll  follow the following 5 methods.</p>
<ol>
<li><strong>Importing</strong> the model.</li>
<li><strong>Instantiating</strong> the model with the hyperparameters of interest.</li>
<li><strong>Fitting</strong> the model to the training data.</li>
<li><strong>Predicting</strong> on the test data.</li>
<li><strong>Scoring</strong> the model by comparing the predictions to the actual values.</li>
</ol>
<p>I&rsquo;ll follow the above steps in modelling each of the ensemble methods: <strong>BaggingClassifier</strong>, <strong>RandomForestClassifier</strong>, and <strong>AdaBoostClassifier</strong>.</p>
<p>For more info about the above ensemble methods can be found below:</p>
<ul>
<li><a href="http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.BaggingClassifier.html#sklearn.ensemble.BaggingClassifier">BaggingClassifier</a></li>
<li><a href="http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html#sklearn.ensemble.RandomForestClassifier">RandomForestClassifier</a></li>
<li><a href="http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.AdaBoostClassifier.html#sklearn.ensemble.AdaBoostClassifier">AdaBoostClassifier</a></li>
</ul>
<p>Another really useful guide for ensemble methods can be found <a href="http://scikit-learn.org/stable/modules/ensemble.html">in the documentation here</a>.</p>
<blockquote>
<p><strong>Step 1</strong>: First I&rsquo;ll <code>import</code> the models from <code>sklearn</code> and use them to instatiate the class.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Importing the Bagging, RandomForest, and AdaBoost Classifier.</span>
<span style="color:#f92672">from</span> sklearn.ensemble <span style="color:#f92672">import</span> RandomForestClassifier,AdaBoostClassifier
</code></pre></div><blockquote>
<p><strong>Step 2:</strong> Now that I  have imported each of the classifiers, I&rsquo;ll <code>instantiate</code> each with the hyperparameters specified in each comment.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Instantiating a RandomForestClassifier with:</span>
<span style="color:#75715e"># 200 weak learners (n_estimators) and everything else as default values</span>
mod_rf <span style="color:#f92672">=</span> RandomForestClassifier(n_estimators<span style="color:#f92672">=</span><span style="color:#ae81ff">500</span>)

<span style="color:#75715e"># Instantiating an a AdaBoostClassifier with:</span>
<span style="color:#75715e"># With 300 weak learners (n_estimators) and a learning_rate of 0.2</span>
mod_ada <span style="color:#f92672">=</span> AdaBoostClassifier(n_estimators<span style="color:#f92672">=</span><span style="color:#ae81ff">600</span>, learning_rate<span style="color:#f92672">=</span><span style="color:#ae81ff">0.2</span>)
</code></pre></div><blockquote>
<p><strong>Step 3:</strong> Now that I have instantiated each of the models, I&rsquo;ll <code>fit</code> them using the <strong>X_train</strong> and <strong>y_train</strong>.  This may take a bit of time, I&rsquo;m fitting 1100 weak learners after all!</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Fit your RandomForestClassifier to the training data</span>
mod_rf<span style="color:#f92672">.</span>fit(X_train, y_train)

<span style="color:#75715e"># Fit your AdaBoostClassifier to the training data</span>
mod_ada<span style="color:#f92672">.</span>fit(X_train, y_train)
</code></pre></div><pre><code>AdaBoostClassifier(algorithm='SAMME.R', base_estimator=None, learning_rate=0.2,
                   n_estimators=600, random_state=None)
</code></pre>
<blockquote>
<p><strong>Step 4:</strong> Now that I have fit each of the models, I will use each to <code>predict</code> on the <strong>testing_data</strong>.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Predicting using RandomForestClassifier on the test set data</span>
preds_rf <span style="color:#f92672">=</span> mod_rf<span style="color:#f92672">.</span>predict(X_test)

<span style="color:#75715e"># Predicting using AdaBoostClassifier on the test set data</span>
preds_ada <span style="color:#f92672">=</span> mod_ada<span style="color:#f92672">.</span>predict(X_test)

</code></pre></div><blockquote>
<p><strong>Step 5:</strong> Now that I have made the predictions, I&rsquo;ll compare the predictions to the actual values using the function below for each of the models - this will give  the <code>score</code> for how well each of the models is performing.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Print Random Forest scores</span>
model_metrics(y_test, preds_rf, <span style="color:#e6db74">&#39;random forest&#39;</span>)

<span style="color:#75715e"># Print AdaBoost scores</span>
model_metrics(y_test, preds_rf, <span style="color:#e6db74">&#39;adaboost&#39;</span>)
</code></pre></div><pre><code>Accuracy score for random forest : 0.832089552238806
Precision score for random forest : 0.8556701030927835
Recall score for random forest : 0.7280701754385965
F1 score for random forest : 0.7867298578199052



Accuracy score for adaboost : 0.832089552238806
Precision score for adaboost : 0.8556701030927835
Recall score for adaboost : 0.7280701754385965
F1 score for adaboost : 0.7867298578199052
</code></pre>
<p>From above it&rsquo;s evident that the random forest has an <strong>accuracy</strong> of <strong>83%</strong> with <strong>precision</strong> rate being <strong>86%</strong> while <strong>recall</strong> score being <strong>73%</strong> and <strong>f1</strong> score as <strong>79%</strong> while  adaboost has an <strong>accuracy</strong> of <strong>83%</strong> with <strong>precision</strong> rate being <strong>86%</strong> while <strong>recall</strong> score being <strong>73%</strong> and <strong>f1</strong> score as <strong>79%</strong> which are the same.</p>
<p>Next I&rsquo;ll use below code snippet in coming up with confusion matrix and make deduction on how the features have been predicted.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> confusion_matrix

<span style="color:#66d9ef">for</span> m, model <span style="color:#f92672">in</span> enumerate([mod_rf,mod_ada]):
    confusion_mat<span style="color:#f92672">=</span> confusion_matrix(y_test, model<span style="color:#f92672">.</span>predict(X_test))
    confusion_mat<span style="color:#f92672">=</span> confusion_mat<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;float&#39;</span>) <span style="color:#f92672">/</span> confusion_mat<span style="color:#f92672">.</span>sum(axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)[:, np<span style="color:#f92672">.</span>newaxis] <span style="color:#75715e"># normalizing the data</span>

    <span style="color:#75715e"># Plot the heatmap</span>
    plt<span style="color:#f92672">.</span>figure(m)
    sns<span style="color:#f92672">.</span>heatmap(confusion_mat, annot<span style="color:#f92672">=</span>True, annot_kws<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;size&#34;</span>:<span style="color:#ae81ff">30</span>}, cmap<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Reds&#39;</span>, square<span style="color:#f92672">=</span>True, fmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;.3f&#39;</span>)
    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;True label&#39;</span>, fontdict<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;size&#34;</span>:<span style="color:#ae81ff">14</span>})
    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Predicted label&#39;</span>,fontdict<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;size&#34;</span>:<span style="color:#ae81ff">14</span>})
    plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Confusion matrix for:</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">{}&#39;</span><span style="color:#f92672">.</span>format(model<span style="color:#f92672">.</span>__class__<span style="color:#f92672">.</span>__name__),fontdict<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;size&#34;</span>:<span style="color:#ae81ff">14</span>});
</code></pre></div><p><img src="Titanic_Project_Final_files/Titanic_Project_Final_167_0.png" alt="png"></p>
<p><img src="Titanic_Project_Final_files/Titanic_Project_Final_167_1.png" alt="png"></p>
<p>In *<em>Random Forest</em> <strong>91%</strong> of the labels was correctly predicted as <strong>death</strong> and <strong>73%</strong> as <strong>survived</strong> while <strong>27%</strong> of the <strong>survived</strong> label was predicted incorrectly and <strong>9%</strong> of death labels were misclassified as <strong>survived</strong>.</p>
<p>In *<em>AdaBoost</em> <strong>86%</strong> of the labels was correctly predicted as <strong>death</strong> and <strong>66%</strong> as <strong>survived</strong> while <strong>34%</strong> of the <strong>survived</strong> label was predicted incorrectly and <strong>14%</strong> of death labels were misclassified as <strong>survived</strong>.</p>
<p>Finally I&rsquo;ll compare all the algorithms that I have used in training the model and choose which is the best and use it tuning the model and also in making general overal deduction of the model perfomance.</p>
<table>
<thead>
<tr>
<th align="center"><strong>Algorithm Name</strong></th>
<th align="center"><strong>Accuracy score</strong></th>
<th align="center"><strong>Precision score</strong></th>
<th align="center"><strong>Recall score</strong></th>
<th align="center"><strong>F1 score</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><strong>Logistic Regression</strong></td>
<td align="center">0.76865671641791</td>
<td align="center">0.7826086956521740</td>
<td align="center">0.631578947368421</td>
<td align="center">0.699029126213592</td>
</tr>
<tr>
<td align="center"><strong>K-Nearest Neighbors</strong></td>
<td align="center">0.59328358208965</td>
<td align="center">0.5242718446601942</td>
<td align="center">0.473684210526316</td>
<td align="center">0.4976958525345622</td>
</tr>
<tr>
<td align="center"><strong>Decision Tree</strong></td>
<td align="center">0.73880597014926</td>
<td align="center">0.7340425531914894</td>
<td align="center">0.605263157894737</td>
<td align="center">0.6634615384615384</td>
</tr>
<tr>
<td align="center"><strong>Support Vector Machine</strong></td>
<td align="center">0.75373134328358</td>
<td align="center">0.7500000000000000</td>
<td align="center">0.631578947368421</td>
<td align="center">0.6857142857142857</td>
</tr>
<tr>
<td align="center"><strong>AdaBoost</strong></td>
<td align="center">0.83208955223880</td>
<td align="center">0.8556701030927835</td>
<td align="center">0.728070175438597</td>
<td align="center">0.7867298578199052</td>
</tr>
<tr>
<td align="center"><strong>Random Forest</strong></td>
<td align="center">0.83208955223880</td>
<td align="center">0.8556701030927835</td>
<td align="center">0.728070175438597</td>
<td align="center">0.7867298578199052</td>
</tr>
</tbody>
</table>
<p>From above table it&rsquo;s evident that adaboost and random forest are the best algorithm for training the overal perfomance of the model and also it&rsquo;s tuning process.</p>
<p>Next I&rsquo;ll use adaboost in tuning the model to see it&rsquo;s improvement i&quot;ll use gridsearchCv method of model tuning.</p>
<h1 id="4-optimizing-the-model">4. Optimizing The Model.</h1>
<h1 id="41-gridsearchcv">4.1 GridSearchCV.</h1>
<p>GridsearchCV is a method of tuning wherein the model can be built by evaluating the combination of parameters mentioned in a grid.</p>
<p>I can conduct a grid search much more easily in practice by leveraging <strong>model_selection.GridSearchCV</strong>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Importing &#39;GridSearchCV&#39;, &#39;make_scorer&#39; </span>
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> GridSearchCV
<span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> make_scorer

<span style="color:#75715e"># Starting the timer</span>
start <span style="color:#f92672">=</span> time()

<span style="color:#75715e"># Initializing the classifier</span>
mod_ada <span style="color:#f92672">=</span> AdaBoostClassifier(base_estimator <span style="color:#f92672">=</span> DecisionTreeClassifier())

<span style="color:#75715e"># Creating the parameters list for tuning</span>
parameters <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;n_estimators&#39;</span>:[<span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">120</span>], 
              <span style="color:#e6db74">&#39;learning_rate&#39;</span>:[<span style="color:#ae81ff">0.1</span>, <span style="color:#ae81ff">0.5</span>, <span style="color:#ae81ff">1.</span>],
              <span style="color:#e6db74">&#39;base_estimator__min_samples_split&#39;</span> : np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">2</span>),
              <span style="color:#e6db74">&#39;base_estimator__max_depth&#39;</span> : np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1</span>)
             }

<span style="color:#75715e"># Making an fbeta_score scoring object</span>
scorer <span style="color:#f92672">=</span> make_scorer(fbeta_score,beta<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)

<span style="color:#75715e"># Perform grid search on the classifier using &#39;scorer&#39; as the scoring method</span>
grid_search <span style="color:#f92672">=</span> GridSearchCV(mod_ada, parameters, scorer)

<span style="color:#75715e"># Fitting the grid search object to the training data and finding the optimal parameters</span>
grid_fit <span style="color:#f92672">=</span> grid_search<span style="color:#f92672">.</span>fit(X_train, y_train)

<span style="color:#75715e"># Getting the estimator</span>
best_mod <span style="color:#f92672">=</span> grid_fit<span style="color:#f92672">.</span>best_estimator_

<span style="color:#75715e"># Making predictions using the unoptimized and model</span>
predictions <span style="color:#f92672">=</span> (clf<span style="color:#f92672">.</span>fit(X_train, y_train))<span style="color:#f92672">.</span>predict(X_test)
best_predictions <span style="color:#f92672">=</span> best_mod<span style="color:#f92672">.</span>predict(X_test)

<span style="color:#75715e"># Report the before-and-afterscores</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Unoptimized model</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">------&#34;</span>)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Accuracy score on testing data: {:.4f}&#34;</span><span style="color:#f92672">.</span>format(accuracy_score(y_test, predictions)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;F-score on testing data: {:.4f}&#34;</span><span style="color:#f92672">.</span>format(fbeta_score(y_test, predictions, beta <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Optimized Model</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">------&#34;</span>)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Final accuracy score on the testing data: {:.4f}&#34;</span><span style="color:#f92672">.</span>format(accuracy_score(y_test, best_predictions)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Final F-score on the testing data: {:.4f}&#34;</span><span style="color:#f92672">.</span>format(fbeta_score(y_test, best_predictions, beta <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>)))
<span style="color:#66d9ef">print</span>(best_mod)

<span style="color:#75715e"># Printing runtime</span>
end <span style="color:#f92672">=</span> time()
runtime <span style="color:#f92672">=</span> end <span style="color:#f92672">-</span> start
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Runtime:&#34;</span>, runtime)
</code></pre></div><pre><code>Unoptimized model
------
Accuracy score on testing data: 0.7425
F-score on testing data: 0.7072

Optimized Model
------
Final accuracy score on the testing data: 0.7873
Final F-score on the testing data: 0.7792
AdaBoostClassifier(algorithm='SAMME.R',
                   base_estimator=DecisionTreeClassifier(ccp_alpha=0.0,
                                                         class_weight=None,
                                                         criterion='gini',
                                                         max_depth=2,
                                                         max_features=None,
                                                         max_leaf_nodes=None,
                                                         min_impurity_decrease=0.0,
                                                         min_impurity_split=None,
                                                         min_samples_leaf=1,
                                                         min_samples_split=2,
                                                         min_weight_fraction_leaf=0.0,
                                                         presort='deprecated',
                                                         random_state=None,
                                                         splitter='best'),
                   learning_rate=0.1, n_estimators=20, random_state=None)
Runtime: 64.8770227432251
</code></pre>
<h1 id="5-feature-importance">5. Feature Importance.</h1>
<p>In any supervised machine learning model it&rsquo;s best to identify the features that affect how the model perfom best.Like in the titanic case I identify which features most affect the survival rate of passengers in the titanic.</p>
<p>From all the features in the titanic dataset I&rsquo;ll use only the top 5 of the features that affect the how the model perfom as shown below</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">feature_plot</span>(importances, X_train, y_train):
    
    <span style="color:#75715e"># Displaying the five most important features</span>
    indices <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>argsort(importances)[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
    columns <span style="color:#f92672">=</span> X_train<span style="color:#f92672">.</span>columns<span style="color:#f92672">.</span>values[indices[:<span style="color:#ae81ff">5</span>]]
    values <span style="color:#f92672">=</span> importances[indices][:<span style="color:#ae81ff">5</span>]

    <span style="color:#75715e"># Creating the plot</span>
    fig <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>figure(figsize <span style="color:#f92672">=</span> (<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">5</span>))
    plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;Normalized Weights for First Five Most Predictive Features&#34;</span>, fontsize <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>)
    plt<span style="color:#f92672">.</span>bar(np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">5</span>), values, width <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.6</span>, align<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;center&#34;</span>, color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;#00A000&#39;</span>, \
          label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Feature Weight&#34;</span>)
    plt<span style="color:#f92672">.</span>bar(np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">5</span>) <span style="color:#f92672">-</span> <span style="color:#ae81ff">0.3</span>, np<span style="color:#f92672">.</span>cumsum(values), width <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.2</span>, align <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;center&#34;</span>, color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;#00A0A0&#39;</span>, \
          label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Cumulative Feature Weight&#34;</span>)
    plt<span style="color:#f92672">.</span>xticks(np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">5</span>), columns)
    plt<span style="color:#f92672">.</span>xlim((<span style="color:#f92672">-</span><span style="color:#ae81ff">0.5</span>, <span style="color:#ae81ff">4.5</span>))
    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;Weight&#34;</span>, fontsize <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>)
    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;Feature&#34;</span>, fontsize <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>)
    
    plt<span style="color:#f92672">.</span>legend(loc <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;upper center&#39;</span>)
    plt<span style="color:#f92672">.</span>tight_layout()
    plt<span style="color:#f92672">.</span>show()  

</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Importing a supervised learning model that has &#39;feature_importances_&#39;</span>
<span style="color:#f92672">from</span> sklearn.ensemble <span style="color:#f92672">import</span> AdaBoostClassifier

<span style="color:#75715e"># Training the supervised model on the training set </span>
model <span style="color:#f92672">=</span> AdaBoostClassifier()<span style="color:#f92672">.</span>fit(X_train,y_train)

<span style="color:#75715e"># Extracting the feature importances</span>
importances <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>feature_importances_

<span style="color:#75715e"># Plotting features.</span>
feature_plot(importances, X_train, y_train)
</code></pre></div><p><img src="Titanic_Project_Final_files/Titanic_Project_Final_177_0.png" alt="png"></p>
<h1 id="51-feature-selection">5.1. Feature Selection.</h1>
<p>An interesting thing to think about here is that how does a model perform if we only use a subset of all the available features in the data? With less features required to train, the expectation is that training and prediction time is much lower, at the cost of performance metrics. From the visualization above, we see that the top five most important features contribute more than half of the importance of all features present in the data. This hints that we can attempt to reduce the feature space and simplify the information required for the model to learn. The code cell below will use the same optimized model we found earlier, and train it on the same training set with only the top five important features.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Importting functionality for cloning a model</span>
<span style="color:#f92672">from</span> sklearn.base <span style="color:#f92672">import</span> clone

<span style="color:#75715e"># Reducing the feature space</span>
X_train_reduced <span style="color:#f92672">=</span> X_train[X_train<span style="color:#f92672">.</span>columns<span style="color:#f92672">.</span>values[(np<span style="color:#f92672">.</span>argsort(importances)[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])[:<span style="color:#ae81ff">5</span>]]]
X_test_reduced <span style="color:#f92672">=</span> X_test[X_test<span style="color:#f92672">.</span>columns<span style="color:#f92672">.</span>values[(np<span style="color:#f92672">.</span>argsort(importances)[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])[:<span style="color:#ae81ff">5</span>]]]

<span style="color:#75715e"># Training on the &#34;best&#34; model found from grid search earlier</span>
mod_ada <span style="color:#f92672">=</span> (clone(best_mod))<span style="color:#f92672">.</span>fit(X_train_reduced, y_train)

<span style="color:#75715e"># Making new predictions</span>
reduced_predictions <span style="color:#f92672">=</span> mod_ada<span style="color:#f92672">.</span>predict(X_test_reduced)

<span style="color:#75715e"># Reporting scores from the final model using both versions of data</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Final Model trained on full data</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">------&#34;</span>)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Accuracy on testing data: {:.4f}&#34;</span><span style="color:#f92672">.</span>format(accuracy_score(y_test, best_predictions)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;F-score on testing data: {:.4f}&#34;</span><span style="color:#f92672">.</span>format(fbeta_score(y_test, best_predictions, beta <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Final Model trained on reduced data</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">------&#34;</span>)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Accuracy on testing data: {:.4f}&#34;</span><span style="color:#f92672">.</span>format(accuracy_score(y_test, reduced_predictions)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;F-score on testing data: {:.4f}&#34;</span><span style="color:#f92672">.</span>format(fbeta_score(y_test, reduced_predictions, beta <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>)))
</code></pre></div><pre><code>Final Model trained on full data
------
Accuracy on testing data: 0.7873
F-score on testing data: 0.7792

Final Model trained on reduced data
------
Accuracy on testing data: 0.6754
F-score on testing data: 0.6150
</code></pre>
<p>From above it can be seen that training on full data gives the best score as compared to training on reduced data since there is reduction in score from 78% to 68%.Therefore it&rsquo;s best to make inference on features that make great impact to the model but not training using the only those features but on whole features.</p>
<p>Thank you for going through my first project in my blog stay in touch for more complex projects,</p>

  
  <h4><i class="fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=%2fpost%2ftitanic_project_final%2f" target="_blank" title="Share on Facebook"><i class="fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=%2fpost%2ftitanic_project_final%2f&via=HorribleGeek" target="_blank" title="Tweet"><i class="fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=%2fpost%2ftitanic_project_final%2f" target="_blank" title="Share on Google+"><i class="fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=%2fpost%2ftitanic_project_final%2f" target="_blank" title="Post to Tumblr"><i class="fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=%2fpost%2ftitanic_project_final%2f" target="_blank" title="Pin it"><i class="fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=%2fpost%2ftitanic_project_final%2f" target="_blank" title="Submit to Reddit"><i class="fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="/post/creating-a-new-theme/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="/post/creating-a-new-theme/">Creating a New Theme</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
  </div>
</div>



  
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'Your Disqus shortname';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


</div>

</div>
</div>
<script src="/js/ui.js"></script>
<script src="/js/menus.js"></script>


<script>
  
  if (window.location.hostname != "localhost") {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'Your Google Analytics tracking ID', 'auto');
    ga('send', 'pageview');
  }
</script>





<script src="/js/math-code.js"></script>
  <script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

