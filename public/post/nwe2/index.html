<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.74.3" />

  <title>Titanic project &middot; Nyakerabachi# Blog Posts</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="/css/blackburn.css">

  
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.9.0/css/all.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="/">Blackburn</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/musarioba" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/musa" rel="me" target="_blank"><i class="fab fa-linkedin"></i></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/musanyaks" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>Musa R. Nyakerabachi&copy; 2020. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Titanic project</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>01 Jan 0001, 00:00</time>
  </div>

  

  

  

</div>

  


<div id="r-markdown" class="section level2">
<h2>R Markdown</h2>
<pre class="r"><code>train &lt;- read.csv (file.choose(), stringsAsFactors = F,na.strings=c(&quot;&quot;,&quot;NA&quot;,&quot; &quot;))
test &lt;- read.csv (file.choose(), stringsAsFactors = F,na.strings=c(&quot;&quot;,&quot;NA&quot;,&quot; &quot;))</code></pre>
</div>
<div id="including-plots" class="section level2">
<h2>Including Plots</h2>
<p>You can also embed plots, for example:</p>
<pre class="r"><code>str(train)</code></pre>
<pre><code>## &#39;data.frame&#39;:    891 obs. of  12 variables:
##  $ PassengerId: int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Survived   : int  0 1 1 1 0 0 0 0 1 1 ...
##  $ Pclass     : int  3 1 3 1 3 3 1 3 3 2 ...
##  $ Name       : chr  &quot;Braund, Mr. Owen Harris&quot; &quot;Cumings, Mrs. John Bradley (Florence Briggs Thayer)&quot; &quot;Heikkinen, Miss. Laina&quot; &quot;Futrelle, Mrs. Jacques Heath (Lily May Peel)&quot; ...
##  $ Sex        : chr  &quot;male&quot; &quot;female&quot; &quot;female&quot; &quot;female&quot; ...
##  $ Age        : num  22 38 26 35 35 NA 54 2 27 14 ...
##  $ SibSp      : int  1 1 0 1 0 0 0 3 0 1 ...
##  $ Parch      : int  0 0 0 0 0 0 0 1 2 0 ...
##  $ Ticket     : chr  &quot;A/5 21171&quot; &quot;PC 17599&quot; &quot;STON/O2. 3101282&quot; &quot;113803&quot; ...
##  $ Fare       : num  7.25 71.28 7.92 53.1 8.05 ...
##  $ Cabin      : chr  NA &quot;C85&quot; NA &quot;C123&quot; ...
##  $ Embarked   : chr  &quot;S&quot; &quot;C&quot; &quot;S&quot; &quot;S&quot; ...</code></pre>
<pre class="r"><code>str(test)</code></pre>
<pre><code>## &#39;data.frame&#39;:    418 obs. of  11 variables:
##  $ PassengerId: int  892 893 894 895 896 897 898 899 900 901 ...
##  $ Pclass     : int  3 3 2 3 3 3 3 2 3 3 ...
##  $ Name       : chr  &quot;Kelly, Mr. James&quot; &quot;Wilkes, Mrs. James (Ellen Needs)&quot; &quot;Myles, Mr. Thomas Francis&quot; &quot;Wirz, Mr. Albert&quot; ...
##  $ Sex        : chr  &quot;male&quot; &quot;female&quot; &quot;male&quot; &quot;male&quot; ...
##  $ Age        : num  34.5 47 62 27 22 14 30 26 18 21 ...
##  $ SibSp      : int  0 1 0 0 1 0 0 1 0 2 ...
##  $ Parch      : int  0 0 0 0 1 0 0 1 0 0 ...
##  $ Ticket     : chr  &quot;330911&quot; &quot;363272&quot; &quot;240276&quot; &quot;315154&quot; ...
##  $ Fare       : num  7.83 7 9.69 8.66 12.29 ...
##  $ Cabin      : chr  NA NA NA NA ...
##  $ Embarked   : chr  &quot;Q&quot; &quot;S&quot; &quot;Q&quot; &quot;S&quot; ...</code></pre>
<pre class="r"><code>summary(train)</code></pre>
<pre><code>##   PassengerId       Survived          Pclass          Name          
##  Min.   :  1.0   Min.   :0.0000   Min.   :1.000   Length:891        
##  1st Qu.:223.5   1st Qu.:0.0000   1st Qu.:2.000   Class :character  
##  Median :446.0   Median :0.0000   Median :3.000   Mode  :character  
##  Mean   :446.0   Mean   :0.3838   Mean   :2.309                     
##  3rd Qu.:668.5   3rd Qu.:1.0000   3rd Qu.:3.000                     
##  Max.   :891.0   Max.   :1.0000   Max.   :3.000                     
##                                                                     
##      Sex                 Age            SibSp           Parch       
##  Length:891         Min.   : 0.42   Min.   :0.000   Min.   :0.0000  
##  Class :character   1st Qu.:20.12   1st Qu.:0.000   1st Qu.:0.0000  
##  Mode  :character   Median :28.00   Median :0.000   Median :0.0000  
##                     Mean   :29.70   Mean   :0.523   Mean   :0.3816  
##                     3rd Qu.:38.00   3rd Qu.:1.000   3rd Qu.:0.0000  
##                     Max.   :80.00   Max.   :8.000   Max.   :6.0000  
##                     NA&#39;s   :177                                     
##     Ticket               Fare           Cabin             Embarked        
##  Length:891         Min.   :  0.00   Length:891         Length:891        
##  Class :character   1st Qu.:  7.91   Class :character   Class :character  
##  Mode  :character   Median : 14.45   Mode  :character   Mode  :character  
##                     Mean   : 32.20                                        
##                     3rd Qu.: 31.00                                        
##                     Max.   :512.33                                        
## </code></pre>
<pre class="r"><code>summary(test)</code></pre>
<pre><code>##   PassengerId         Pclass          Name               Sex           
##  Min.   : 892.0   Min.   :1.000   Length:418         Length:418        
##  1st Qu.: 996.2   1st Qu.:1.000   Class :character   Class :character  
##  Median :1100.5   Median :3.000   Mode  :character   Mode  :character  
##  Mean   :1100.5   Mean   :2.266                                        
##  3rd Qu.:1204.8   3rd Qu.:3.000                                        
##  Max.   :1309.0   Max.   :3.000                                        
##                                                                        
##       Age            SibSp            Parch           Ticket         
##  Min.   : 0.17   Min.   :0.0000   Min.   :0.0000   Length:418        
##  1st Qu.:21.00   1st Qu.:0.0000   1st Qu.:0.0000   Class :character  
##  Median :27.00   Median :0.0000   Median :0.0000   Mode  :character  
##  Mean   :30.27   Mean   :0.4474   Mean   :0.3923                     
##  3rd Qu.:39.00   3rd Qu.:1.0000   3rd Qu.:0.0000                     
##  Max.   :76.00   Max.   :8.0000   Max.   :9.0000                     
##  NA&#39;s   :86                                                          
##       Fare            Cabin             Embarked        
##  Min.   :  0.000   Length:418         Length:418        
##  1st Qu.:  7.896   Class :character   Class :character  
##  Median : 14.454   Mode  :character   Mode  :character  
##  Mean   : 35.627                                        
##  3rd Qu.: 31.500                                        
##  Max.   :512.329                                        
##  NA&#39;s   :1</code></pre>
<pre class="r"><code>test$Survived &lt;- 0
my_solution &lt;- data.frame(PassengerId = test$PassengerId, Survived = test$Survived)</code></pre>
<pre class="r"><code>nrow(my_solution)</code></pre>
<pre><code>## [1] 418</code></pre>
<pre class="r"><code>write.csv(my_solution, file = &quot;Lazy_Predictor.csv&quot;, row.names = FALSE)</code></pre>
<pre class="r"><code>test$Survived [test$Sex == &quot;female&quot;] &lt;- 1

my_solution &lt;- data.frame(PassengerId = test$PassengerId, Survived = test$Survived)</code></pre>
<pre class="r"><code>nrow(my_solution)</code></pre>
<pre><code>## [1] 418</code></pre>
<pre class="r"><code>write.csv(my_solution, file = &quot;Gender_Model.csv&quot;, row.names = FALSE)</code></pre>
<pre class="r"><code>Full &lt;- rbind(train,test)</code></pre>
<pre class="r"><code>str(Full)</code></pre>
<pre><code>## &#39;data.frame&#39;:    1309 obs. of  12 variables:
##  $ PassengerId: int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Survived   : num  0 1 1 1 0 0 0 0 1 1 ...
##  $ Pclass     : int  3 1 3 1 3 3 1 3 3 2 ...
##  $ Name       : chr  &quot;Braund, Mr. Owen Harris&quot; &quot;Cumings, Mrs. John Bradley (Florence Briggs Thayer)&quot; &quot;Heikkinen, Miss. Laina&quot; &quot;Futrelle, Mrs. Jacques Heath (Lily May Peel)&quot; ...
##  $ Sex        : chr  &quot;male&quot; &quot;female&quot; &quot;female&quot; &quot;female&quot; ...
##  $ Age        : num  22 38 26 35 35 NA 54 2 27 14 ...
##  $ SibSp      : int  1 1 0 1 0 0 0 3 0 1 ...
##  $ Parch      : int  0 0 0 0 0 0 0 1 2 0 ...
##  $ Ticket     : chr  &quot;A/5 21171&quot; &quot;PC 17599&quot; &quot;STON/O2. 3101282&quot; &quot;113803&quot; ...
##  $ Fare       : num  7.25 71.28 7.92 53.1 8.05 ...
##  $ Cabin      : chr  NA &quot;C85&quot; NA &quot;C123&quot; ...
##  $ Embarked   : chr  &quot;S&quot; &quot;C&quot; &quot;S&quot; &quot;S&quot; ...</code></pre>
<pre class="r"><code>summary(Full)</code></pre>
<pre><code>##   PassengerId      Survived          Pclass          Name          
##  Min.   :   1   Min.   :0.0000   Min.   :1.000   Length:1309       
##  1st Qu.: 328   1st Qu.:0.0000   1st Qu.:2.000   Class :character  
##  Median : 655   Median :0.0000   Median :3.000   Mode  :character  
##  Mean   : 655   Mean   :0.3774   Mean   :2.295                     
##  3rd Qu.: 982   3rd Qu.:1.0000   3rd Qu.:3.000                     
##  Max.   :1309   Max.   :1.0000   Max.   :3.000                     
##                                                                    
##      Sex                 Age            SibSp            Parch      
##  Length:1309        Min.   : 0.17   Min.   :0.0000   Min.   :0.000  
##  Class :character   1st Qu.:21.00   1st Qu.:0.0000   1st Qu.:0.000  
##  Mode  :character   Median :28.00   Median :0.0000   Median :0.000  
##                     Mean   :29.88   Mean   :0.4989   Mean   :0.385  
##                     3rd Qu.:39.00   3rd Qu.:1.0000   3rd Qu.:0.000  
##                     Max.   :80.00   Max.   :8.0000   Max.   :9.000  
##                     NA&#39;s   :263                                     
##     Ticket               Fare            Cabin             Embarked        
##  Length:1309        Min.   :  0.000   Length:1309        Length:1309       
##  Class :character   1st Qu.:  7.896   Class :character   Class :character  
##  Mode  :character   Median : 14.454   Mode  :character   Mode  :character  
##                     Mean   : 33.295                                        
##                     3rd Qu.: 31.275                                        
##                     Max.   :512.329                                        
##                     NA&#39;s   :1</code></pre>
<pre class="r"><code>table(Full$Survived)</code></pre>
<pre><code>## 
##   0   1 
## 815 494</code></pre>
<pre class="r"><code>prop.table(table(Full$Survived))</code></pre>
<pre><code>## 
##         0         1 
## 0.6226127 0.3773873</code></pre>
<pre class="r"><code>Full$Pclass = as.factor(Full$Pclass)</code></pre>
<pre class="r"><code>sapply(Full, function(df)
{
  sum(is.na(df)==T)/length(df)
})</code></pre>
<pre><code>##  PassengerId     Survived       Pclass         Name          Sex          Age 
## 0.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000 0.2009167303 
##        SibSp        Parch       Ticket         Fare        Cabin     Embarked 
## 0.0000000000 0.0000000000 0.0000000000 0.0007639419 0.7746371276 0.0015278839</code></pre>
<pre class="r"><code>library(&quot;Amelia&quot;)</code></pre>
<pre><code>## Loading required package: Rcpp</code></pre>
<pre><code>## ## 
## ## Amelia II: Multiple Imputation
## ## (Version 1.7.6, built: 2019-11-24)
## ## Copyright (C) 2005-2020 James Honaker, Gary King and Matthew Blackwell
## ## Refer to http://gking.harvard.edu/amelia/ for more information
## ##</code></pre>
<pre class="r"><code>missmap(Full, main = &quot;Missing Map&quot;)</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r"><code>Full$Age[is.na(Full$Age)] &lt;- mean(Full$Age,na.rm=T)
sum(is.na(Full$Age))</code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="r"><code>table(Full$Embarked, useNA = &quot;always&quot;)</code></pre>
<pre><code>## 
##    C    Q    S &lt;NA&gt; 
##  270  123  914    2</code></pre>
<pre class="r"><code>Full$Embarked[is.na(Full$Embarked)] &lt;- &#39;S&#39;
sum(is.na(Full$Embarked))</code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="r"><code>table(Full$Embarked, useNA = &quot;always&quot;)</code></pre>
<pre><code>## 
##    C    Q    S &lt;NA&gt; 
##  270  123  916    0</code></pre>
<pre class="r"><code>Full$Fare[is.na(Full$Fare)] &lt;- mean(Full$Fare,na.rm=T)
sum(is.na(Full$Fare))</code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="r"><code>Full &lt;- Full[-11]</code></pre>
<pre class="r"><code>sapply(Full, function(df)
{
  sum(is.na(df)==T)/length(df)
})</code></pre>
<pre><code>## PassengerId    Survived      Pclass        Name         Sex         Age 
##           0           0           0           0           0           0 
##       SibSp       Parch      Ticket        Fare    Embarked 
##           0           0           0           0           0</code></pre>
<pre class="r"><code>train_cleaned &lt;- Full[1:891,]
test_cleaned &lt;- Full[892:1309,]</code></pre>
<pre class="r"><code>library(ggplot2)</code></pre>
<pre class="r"><code>xtabs(~Survived,train_cleaned)</code></pre>
<pre><code>## Survived
##   0   1 
## 549 342</code></pre>
<pre class="r"><code>ggplot(train_cleaned) + geom_bar(aes(x=Survived))</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<pre class="r"><code>ggplot(train_cleaned) + geom_bar(aes(x=Sex))</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-24-2.png" width="672" /></p>
<pre class="r"><code>ggplot(train_cleaned) + geom_bar(aes(x=Pclass))</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-24-3.png" width="672" /></p>
<pre class="r"><code>ggplot(train_cleaned) + geom_histogram(aes(x=Fare),fill = &quot;white&quot;, colour = &quot;black&quot;)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<pre class="r"><code>ggplot(train_cleaned) + geom_boxplot(aes(x=factor(0),y=Fare)) + coord_flip()</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-25-2.png" width="672" /></p>
<pre class="r"><code>ggplot(train_cleaned) + geom_histogram(aes(x=Age),fill = &quot;white&quot;, colour = &quot;black&quot;)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-25-3.png" width="672" /></p>
<pre class="r"><code>ggplot(train_cleaned) + geom_boxplot(aes(x=factor(0),y=Age)) + coord_flip()</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-25-4.png" width="672" /></p>
<pre class="r"><code>xtabs(~Survived+Sex,train_cleaned)</code></pre>
<pre><code>##         Sex
## Survived female male
##        0     81  468
##        1    233  109</code></pre>
<pre class="r"><code>ggplot(train_cleaned) + geom_bar(aes(x=Sex, fill=factor(Survived)))</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<pre class="r"><code>xtabs(~Survived+Pclass,train_cleaned)</code></pre>
<pre><code>##         Pclass
## Survived   1   2   3
##        0  80  97 372
##        1 136  87 119</code></pre>
<pre class="r"><code>ggplot(train_cleaned) + geom_bar(aes(x=Pclass, fill=factor(Survived)) )</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-26-2.png" width="672" /></p>
<pre class="r"><code>xtabs(~Survived+Embarked,train_cleaned)</code></pre>
<pre><code>##         Embarked
## Survived   C   Q   S
##        0  75  47 427
##        1  93  30 219</code></pre>
<pre class="r"><code>ggplot(train_cleaned) + geom_bar(aes(x=Embarked, fill=factor(Survived)) )</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-26-3.png" width="672" /></p>
<pre class="r"><code>ggplot(train_cleaned) + geom_boxplot(aes(x = factor(Survived), y = Age))</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<pre class="r"><code>ggplot(train_cleaned) + geom_histogram(aes(x = Age),fill = &quot;white&quot;, colour = &quot;black&quot;) + facet_grid(factor(Survived) ~ .)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-27-2.png" width="672" /></p>
<pre class="r"><code>ggplot(train_cleaned) + geom_boxplot(aes(x = factor(Survived), y = Fare))</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-27-3.png" width="672" /></p>
<pre class="r"><code>ggplot(train_cleaned) + geom_histogram(aes(x = Fare),fill = &quot;white&quot;, colour = &quot;black&quot;) + facet_grid(factor(Survived) ~ .)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-27-4.png" width="672" /></p>
<pre class="r"><code>xtabs(~factor(Survived)+Pclass+Sex,train_cleaned)</code></pre>
<pre><code>## , , Sex = female
## 
##                 Pclass
## factor(Survived)   1   2   3
##                0   3   6  72
##                1  91  70  72
## 
## , , Sex = male
## 
##                 Pclass
## factor(Survived)   1   2   3
##                0  77  91 300
##                1  45  17  47</code></pre>
<pre class="r"><code>ggplot(train_cleaned) + geom_bar(aes(x=Sex, fill=factor(Survived))) + facet_grid(Pclass ~ .)</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<pre class="r"><code>xtabs(~Survived+Embarked+Sex,train_cleaned)</code></pre>
<pre><code>## , , Sex = female
## 
##         Embarked
## Survived   C   Q   S
##        0   9   9  63
##        1  64  27 142
## 
## , , Sex = male
## 
##         Embarked
## Survived   C   Q   S
##        0  66  38 364
##        1  29   3  77</code></pre>
<pre class="r"><code>ggplot(train_cleaned) + geom_bar(aes(x=Sex, fill=factor(Survived))) + facet_grid(Embarked ~ .)</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-28-2.png" width="672" /></p>
<pre class="r"><code>Full$Child &lt;- NA
Full$Child[Full$Age &lt; 18] &lt;- 1
Full$Child[Full$Age &gt;= 18] &lt;- 0
str(Full$Child)</code></pre>
<pre><code>##  num [1:1309] 0 0 0 0 0 0 0 1 0 1 ...</code></pre>
<pre class="r"><code>ggplot(Full) + geom_bar(aes(x=Child))</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<pre class="r"><code>Full$Title &lt;- sapply(Full$Name, FUN=function(x) {strsplit(x, split=&#39;[,.]&#39;)[[1]][2]})
Full$Title &lt;- sub(&#39; &#39;, &#39;&#39;, Full$Title)  # Remove the white space or blank
table(Full$Title)</code></pre>
<pre><code>## 
##         Capt          Col          Don         Dona           Dr     Jonkheer 
##            1            4            1            1            8            1 
##         Lady        Major       Master         Miss         Mlle          Mme 
##            1            2           61          260            2            1 
##           Mr          Mrs           Ms          Rev          Sir the Countess 
##          757          197            2            8            1            1</code></pre>
<pre class="r"><code>ggplot(Full) + geom_bar(aes(x=Title))</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<pre class="r"><code>Full$Title[Full$Title %in% c(&#39;Mme&#39;, &#39;Mlle&#39;)] &lt;- &#39;Mlle&#39;
Full$Title[Full$Title %in% c(&#39;Capt&#39;, &#39;Don&#39;, &#39;Major&#39;, &#39;Sir&#39;)] &lt;- &#39;Sir&#39;
Full$Title[Full$Title %in% c(&#39;Dona&#39;, &#39;Lady&#39;, &#39;the Countess&#39;, &#39;Jonkheer&#39;)] &lt;- &#39;Lady&#39;</code></pre>
<pre class="r"><code>Full$Title &lt;- factor(Full$Title)
table(Full$Title)</code></pre>
<pre><code>## 
##    Col     Dr   Lady Master   Miss   Mlle     Mr    Mrs     Ms    Rev    Sir 
##      4      8      4     61    260      3    757    197      2      8      5</code></pre>
<pre class="r"><code>ggplot(Full) + geom_bar(aes(x=Title))</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<pre class="r"><code>Full$FamilySize &lt;- Full$SibSp + Full$Parch + 1
table(Full$FamilySize)</code></pre>
<pre><code>## 
##   1   2   3   4   5   6   7   8  11 
## 790 235 159  43  22  25  16   8  11</code></pre>
<pre class="r"><code>ggplot(Full) + geom_bar(aes(x=FamilySize))</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<pre class="r"><code>train_Featured &lt;- Full[1:891,]
test_Featured &lt;- Full[892:1309,]

train_Featured$Survived &lt;- as.factor(train_Featured$Survived)
train_Featured$Sex &lt;- as.factor(train_Featured$Sex)
train_Featured$Embarked &lt;- as.factor(train_Featured$Embarked)

test_Featured$Sex &lt;- as.factor(test_Featured$Sex)
test_Featured$Embarked &lt;- as.factor(test_Featured$Embarked)</code></pre>
<pre class="r"><code># Fitting SVM to the Training set
# install.packages(&#39;e1071&#39;)
library(e1071)

svm_model&lt;-svm(Survived ~ Pclass + Sex + Age + SibSp + Parch + Fare + Embarked + Child +Title + FamilySize, data=train_Featured, method = &quot;class&quot;)
summary(svm_model)</code></pre>
<pre><code>## 
## Call:
## svm(formula = Survived ~ Pclass + Sex + Age + SibSp + Parch + Fare + 
##     Embarked + Child + Title + FamilySize, data = train_Featured, 
##     method = &quot;class&quot;)
## 
## 
## Parameters:
##    SVM-Type:  C-classification 
##  SVM-Kernel:  radial 
##        cost:  1 
## 
## Number of Support Vectors:  406
## 
##  ( 205 201 )
## 
## 
## Number of Classes:  2 
## 
## Levels: 
##  0 1</code></pre>
<pre class="r"><code>my_Prediction &lt;- predict(svm_model, test_Featured, type = &quot;class&quot;)

my_solution &lt;- data.frame(PassengerId = test_Featured$PassengerId, Survived = my_Prediction)
write.csv(my_solution, file = &quot;svm.csv&quot;, row.names = FALSE)</code></pre>
<pre class="r"><code>library(rattle)</code></pre>
<pre><code>## Warning: package &#39;rattle&#39; was built under R version 4.0.2</code></pre>
<pre><code>## Loading required package: tibble</code></pre>
<pre><code>## Loading required package: bitops</code></pre>
<pre><code>## Rattle: A free graphical interface for data science with R.
## Version 5.4.0 Copyright (c) 2006-2020 Togaware Pty Ltd.
## Type &#39;rattle()&#39; to shake, rattle, and roll your data.</code></pre>
<pre class="r"><code>library(rpart.plot)</code></pre>
<pre><code>## Loading required package: rpart</code></pre>
<pre class="r"><code>library(RColorBrewer)
library(rpart)</code></pre>
<pre class="r"><code># Recreate the gender model
dtree1 &lt;- rpart(Survived ~ Sex, data=train_Featured, method=&quot;class&quot;)
rpart.plot(dtree1)</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<pre class="r"><code>fancyRpartPlot(dtree1)</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-37-2.png" width="672" /></p>
<pre class="r"><code>my_Prediction &lt;- predict(dtree1, test_Featured, type = &quot;class&quot;)

my_solution &lt;- data.frame(PassengerId = test_Featured$PassengerId, Survived = my_Prediction)
write.csv(my_solution, file = &quot;dtree1.csv&quot;, row.names = FALSE)
###################</code></pre>
<pre class="r"><code>#Build a deeper tree without feature enginnering
dtree2 &lt;- rpart(Survived ~ Pclass + Sex + Age + SibSp + Parch + Fare + Embarked,
              data=train_Featured,
              method=&quot;class&quot;)

rpart.plot(dtree2)</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<pre class="r"><code>fancyRpartPlot(dtree2)</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-38-2.png" width="672" /></p>
<pre class="r"><code>my_Prediction &lt;- predict(dtree2, test_Featured, type = &quot;class&quot;)

my_solution &lt;- data.frame(PassengerId = test_Featured$PassengerId, Survived = my_Prediction)
write.csv(my_solution, file = &quot;dtree2.csv&quot;, row.names = FALSE)</code></pre>
<pre class="r"><code>dtree3 &lt;- rpart(Survived ~ Pclass + Sex + Age + SibSp + Parch + Fare + Embarked + Child +Title + FamilySize,
             data=train_Featured,
             method=&quot;class&quot;)

rpart.plot(dtree3)</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<pre class="r"><code>fancyRpartPlot(dtree3)</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-39-2.png" width="672" /></p>
<pre class="r"><code>my_Prediction &lt;- predict(dtree3, test_Featured, type = &quot;class&quot;)

my_solution &lt;- data.frame(PassengerId = test_Featured$PassengerId, Survived = my_Prediction)
write.csv(my_solution, file = &quot;dtree3.csv&quot;, row.names = FALSE)
######################################################################################</code></pre>
<pre class="r"><code># Go all over and reach max depth of the tree by making cp =0 and minsplit = 2
dtree4 &lt;- rpart(Survived ~ Pclass + Sex + Age + SibSp + Parch + Fare + Embarked + Child +Title + FamilySize,
             data=train_Featured,
             method=&quot;class&quot;, 
             control=rpart.control(minsplit=2, cp=0))

fancyRpartPlot(dtree4)</code></pre>
<pre><code>## Warning: labs do not fit even at cex 0.15, there may be some overplotting</code></pre>
<p><img src="/post/nwe2_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<pre class="r"><code>my_Prediction &lt;- predict(dtree4, test_Featured, type = &quot;class&quot;)
my_solution &lt;- data.frame(PassengerId = test_Featured$PassengerId, Survived = my_Prediction)
write.csv(my_solution, file = &quot;dtree4.csv&quot;, row.names = FALSE)
#Accuracy = 69% -&gt; worst than gender model -&gt; Welcome to overfitting
######################################################################################</code></pre>
<pre class="r"><code># Let&#39;s handle Overfitting Problem
printcp(dtree4) </code></pre>
<pre><code>## 
## Classification tree:
## rpart(formula = Survived ~ Pclass + Sex + Age + SibSp + Parch + 
##     Fare + Embarked + Child + Title + FamilySize, data = train_Featured, 
##     method = &quot;class&quot;, control = rpart.control(minsplit = 2, cp = 0))
## 
## Variables actually used in tree construction:
## [1] Age        Embarked   FamilySize Fare       Parch      Pclass     Sex       
## [8] SibSp      Title     
## 
## Root node error: 342/891 = 0.38384
## 
## n= 891 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.45614035      0  1.000000 1.00000 0.042446
## 2  0.05409357      1  0.543860 0.56140 0.035886
## 3  0.00877193      3  0.435673 0.46784 0.033501
## 4  0.00730994      7  0.400585 0.48538 0.033983
## 5  0.00657895      9  0.385965 0.47953 0.033824
## 6  0.00584795     13  0.359649 0.46199 0.033336
## 7  0.00438596     19  0.324561 0.45614 0.033170
## 8  0.00292398     28  0.283626 0.44444 0.032831
## 9  0.00194932     50  0.219298 0.45614 0.033170
## 10 0.00146199     64  0.190058 0.46491 0.033419
## 11 0.00116959    129  0.093567 0.52339 0.034970
## 12 0.00097466    146  0.070175 0.57895 0.036286
## 13 0.00079745    158  0.058480 0.57895 0.036286
## 14 0.00073099    171  0.046784 0.59357 0.036608
## 15 0.00000000    179  0.040936 0.59649 0.036671</code></pre>
<pre class="r"><code>min(dtree4$cptable[,&quot;xerror&quot;])</code></pre>
<pre><code>## [1] 0.4444444</code></pre>
<pre class="r"><code>which.min(dtree4$cptable[,&quot;xerror&quot;])</code></pre>
<pre><code>## 8 
## 8</code></pre>
<pre class="r"><code>cpmin &lt;- dtree4$cptable[3, &quot;CP&quot;]
cpmin</code></pre>
<pre><code>## [1] 0.00877193</code></pre>
</div>

  
  <h4><i class="fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=%2fpost%2fnwe2%2f" target="_blank" title="Share on Facebook"><i class="fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=%2fpost%2fnwe2%2f&via=HorribleGeek" target="_blank" title="Tweet"><i class="fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=%2fpost%2fnwe2%2f" target="_blank" title="Share on Google+"><i class="fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=%2fpost%2fnwe2%2f" target="_blank" title="Post to Tumblr"><i class="fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=%2fpost%2fnwe2%2f" target="_blank" title="Pin it"><i class="fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=%2fpost%2fnwe2%2f" target="_blank" title="Submit to Reddit"><i class="fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
  </div>
  <div class="pure-u-10-24">
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="/post/hugoisforlovers/">Getting Started with Hugo</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="/post/hugoisforlovers/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'Your Disqus shortname';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


</div>

</div>
</div>
<script src="/js/ui.js"></script>
<script src="/js/menus.js"></script>


<script>
  
  if (window.location.hostname != "localhost") {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'Your Google Analytics tracking ID', 'auto');
    ga('send', 'pageview');
  }
</script>





<script src="/js/math-code.js"></script>
  <script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

